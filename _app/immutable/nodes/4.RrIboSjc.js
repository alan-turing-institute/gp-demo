import{t as pt,a as gt}from"../chunks/XXpPz1rO.js";import"../chunks/CG3dSJ55.js";import{am as kt,as as It,at as zt,ar as Ct,an as Vt,s as b,ao as v,i as Et,e as l,au as k,Q as S,ap as p,aq as Rt}from"../chunks/C9kX8gL9.js";import{e as tt,s as X}from"../chunks/CWldEeeP.js";import{i as Wt}from"../chunks/DDIuJh5f.js";import{s as D}from"../chunks/BK-Xurv5.js";import{l as dt,s as Ft,c as Gt}from"../chunks/C0MQ2VaA.js";import{b as ft}from"../chunks/CUbg1kqr.js";import{i as qt}from"../chunks/CmZZvN_p.js";import{o as Xt}from"../chunks/DWMzei4F.js";import{r as Y,s as Dt,v as ht,z as vt,l as Yt,m as $t,a as Ht,d as Lt,b as Ot,e as Kt}from"../chunks/BoOaU208.js";var Bt=pt('<button class="svelte-jwpglc">Clear Samples</button>'),Nt=pt('<main class="svelte-jwpglc"><h1 class="svelte-jwpglc">Astroid with Velocity Vector Explorer</h1> <div class="container svelte-jwpglc"><div class="panel svelte-jwpglc"><h2 class="svelte-jwpglc">Astroid Visualization</h2> <canvas class="svelte-jwpglc"></canvas></div> <div class="panel svelte-jwpglc"><h2 class="svelte-jwpglc">Energy Landscape</h2> <div class="contour-container svelte-jwpglc"><canvas></canvas></div> <div class="info svelte-jwpglc"><p class="svelte-jwpglc"> </p> <p class="svelte-jwpglc"> </p> <div class="instruction svelte-jwpglc"><p class="highlight svelte-jwpglc">Click on the plot above to add sample points and update the GP model</p></div> <div class="button-group svelte-jwpglc"><!> <button class="info-button svelte-jwpglc"> </button></div> <div class="energy-function svelte-jwpglc"><h3 class="svelte-jwpglc">About the Visualization:</h3> <p class="svelte-jwpglc"> </p> <p class="svelte-jwpglc">The energy function represents different stable conformations of the protein backbone. Darker regions indicate lower energy (more stable conformations).</p> <p class="svelte-jwpglc">Click directly on the plot to add sample points and build a GP model that learns this energy landscape.</p></div></div></div></div></main>');function re(yt,ut){kt(ut,!1);const j={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50"};let M=k(0),P=k(1),x=k([]),I=[],A=k(),z=k(),C=k(!1),V=k(!1);const h=400,d=400,a=40,et=h-2*a,R=dt().domain([0,360]).range([a,h-a]),W=dt().domain([.1,3]).range([d-a,a]);let u=1/0,w=-1/0;function mt(){const r=Y(0,360,7.2).toArray(),i=Y(.1,3,(3-.1)/50).toArray();for(const e of r)for(const o of i){const s=F(e,o);u=Math.min(u,s),w=Math.max(w,s)}u=Math.floor(u*10)/10,w=Math.ceil(w*10)/10,console.log(`Energy range: ${u} to ${w}`)}function F(t,r){const i=t*Math.PI/180,e=.5,o=-1.2,s=Math.cos(i),c=Math.sin(i),f=r*Math.cos(i+Math.PI/2),y=r*Math.sin(i+Math.PI/2),n=s-e,g=c-o,_=f,T=y,m=n*_+g*T,q=_*_+T*T;if(q<1e-4)return Math.sqrt(n*n+g*g);const J=-m/q;let U;if(J<=0)U=Math.sqrt(n*n+g*g);else{const ct=s+f*J,rt=c+y*J;U=Math.sqrt((ct-e)*(ct-e)+(rt-o)*(rt-o))}return Math.max(.1,U*2)}function bt(){S(x,[]),I=[],G()}function St(t){if(l(C))return;const r=l(z).getBoundingClientRect(),i=t.clientX-r.left,e=t.clientY-r.top;if(i>=a&&i<=h-a&&e>=a&&e<=d-a){const o=R.invert(i),s=W.invert(e);S(M,o),S(P,s);const c=F(l(M),l(P)),f=l(M)*Math.PI/180;S(x,[...l(x),{angle:f,velocity:l(P),energy:c}]),xt(),$()}}function xt(){if(S(C,!0),l(x).length===0){S(C,!1);return}setTimeout(()=>{const t=l(x).map(n=>[n.angle,n.velocity]),r=l(x).map(n=>n.energy),i=(n,g,_=1)=>{const T=Ht(Lt(Ot(n,g),2));return Kt(-.5*T/(_*_))},e=t.length,o=vt(e,e);for(let n=0;n<e;n++)for(let g=0;g<e;g++)o.set([n,g],i(t[n],t[g]));const s=.01;for(let n=0;n<e;n++)o.set([n,n],o.get([n,n])+s);const c=40,f=Y(0,2*Math.PI,2*Math.PI/c).toArray(),y=Y(.1,3,(3-.1)/c).toArray();I=[];for(const n of f)for(const g of y){const _=[n,g],T=vt(1,e);for(let m=0;m<e;m++)T.set([0,m],i(_,t[m]));try{const m=Yt(o,r),q=$t(T,m).get([0,0]);I.push({angle:n*180/Math.PI,velocity:g,predicted:q})}catch(m){console.error("Error in GP calculation:",m)}}G(),S(C,!1)},50)}function G(){if(!l(z))return;const t=l(z).getContext("2d");t.clearRect(0,0,h,d);const r=Dt(ht).domain([w,u]).interpolator(ht);if(l(V)||I.length===0){const e=et/80;for(let o=0;o<80;o++)for(let s=0;s<80;s++){const c=360*o/80,f=.1+(3-.1)*s/80,y=F(c,f),n=R(c),g=W(f);t.fillStyle=r(y),t.fillRect(n-e/2,g-e/2,e,e)}}else{const i=et/Math.sqrt(I.length);I.forEach(e=>{const o=R(e.angle),s=W(e.velocity);t.fillStyle=r(e.predicted),t.fillRect(o-i/2,s-i/2,i,i)})}wt(t,r),t.strokeStyle=j.primary,t.lineWidth=2,t.beginPath(),t.moveTo(a,d-a),t.lineTo(h-a,d-a),t.moveTo(a,a),t.lineTo(a,d-a),t.stroke(),t.fillStyle=j.text,t.font="bold 14px Arial, sans-serif",t.textAlign="center",t.fillText("0째",a,d-a+15),t.fillText("180째",h/2,d-a+15),t.fillText("360째",h-a,d-a+15),t.fillText("Angle",h-a+15,d-a+5),t.textAlign="right",t.fillText("0.1",a-5,d-a),t.fillText("1.55",a-5,d/2),t.fillText("3",a-5,a),t.fillText("Velocity",a-15,a-10),l(x).forEach(i=>{const e=R(i.angle*180/Math.PI),o=W(i.velocity),s=8,c=t.createRadialGradient(e,o,2,e,o,s);c.addColorStop(0,j.highlight),c.addColorStop(1,"rgba(106, 137, 204, 0)"),t.fillStyle=c,t.beginPath(),t.arc(e,o,s,0,2*Math.PI),t.fill(),t.fillStyle=j.accent,t.beginPath(),t.arc(e,o,4,0,2*Math.PI),t.fill(),t.strokeStyle=j.primary,t.lineWidth=1,t.stroke()})}function wt(t,r){const e=d-2*a,o=h-a+20,s=a,c=100,f=e/c;for(let n=0;n<c;n++){const g=u+(w-u)*(c-n-1)/c;t.fillStyle=r(g),t.fillRect(o,s+n*f,20,f+1)}t.strokeStyle=j.text,t.lineWidth=1,t.strokeRect(o,s,20,e),t.fillStyle=j.text,t.font="12px Arial, sans-serif",t.textAlign="left",t.fillText(u.toFixed(1),o+20+5,s+e),t.fillText(w.toFixed(1),o+20+5,s);const y=(u+w)/2;t.fillText(y.toFixed(1),o+20+5,s+e/2),t.save(),t.translate(o+20+25,s+e/2),t.rotate(-Math.PI/2),t.textAlign="center",t.fillText("Distance to Earth",0,0),t.restore()}function $(){if(!l(A))return;const t=l(A).getContext("2d");t.clearRect(0,0,h,d);const r=h/2,i=d/2,e=120;t.save(),t.translate(r,i),t.rotate(l(M)*Math.PI/180),t.beginPath();for(let c=0;c<=2*Math.PI;c+=.01){const f=e*Math.pow(Math.cos(c),3),y=e*Math.pow(Math.sin(c),3);c===0?t.moveTo(f,y):t.lineTo(f,y)}t.closePath(),t.fillStyle="rgba(200,200,200,0.3)",t.fill(),t.strokeStyle="#333",t.lineWidth=2,t.stroke();const o=l(P)*50;t.strokeStyle="#cc0000",t.lineWidth=2,t.beginPath(),t.moveTo(e,0),t.lineTo(e+o,0),t.stroke();const s=8;t.beginPath(),t.moveTo(e+o,0),t.lineTo(e+o-s,-8/2),t.lineTo(e+o-s,s/2),t.closePath(),t.fillStyle="#cc0000",t.fill(),t.fillStyle="#0066cc",t.beginPath(),t.arc(0,0,5,0,2*Math.PI),t.fill(),t.fillStyle="#00cc00",t.beginPath(),t.arc(e,0,5,0,2*Math.PI),t.fill(),t.restore(),t.fillStyle="#000",t.font="14px Arial",t.textAlign="left",t.fillText(`Angle: ${l(M)}째`,20,30),t.fillText(`Velocity: ${l(P).toFixed(2)}`,20,50)}function Mt(){S(V,!l(V)),G()}Xt(()=>{console.log("Astroid canvas:",l(A)),console.log("Contour canvas:",l(z)),mt(),$(),G()}),It(()=>(l(A),l(M),l(P)),()=>{l(A)&&(l(M)!==void 0||l(P)!==void 0)&&$()}),zt(),qt();var H=Nt(),lt=b(v(H),2),L=v(lt),O=b(v(L),2);D(O,"width",h),D(O,"height",d),ft(O,t=>S(A,t),()=>l(A)),p(L);var ot=b(L,2),K=b(v(ot),2),E=v(K);D(E,"width",h+60),D(E,"height",d),ft(E,t=>S(z,t),()=>l(z)),p(K);var at=b(K,2),B=v(at),Pt=v(B);p(B);var N=b(B,2),_t=v(N);p(N);var Q=b(N,4),nt=v(Q);{var Tt=t=>{var r=Bt();tt("click",r,bt),gt(t,r)};Wt(nt,t=>{l(x).length>0&&t(Tt)})}var Z=b(nt,2),jt=v(Z,!0);p(Z),p(Q);var st=b(Q,2),it=b(v(st),2),At=v(it,!0);p(it),Rt(4),p(st),p(at),p(ot),p(lt),p(H),Ct(t=>{Ft(E,1,Gt(l(C)?"loading":""),"svelte-jwpglc"),X(Pt,`Samples: ${l(x).length??""}`),X(_t,`Current energy: ${t??""}`),X(jt,l(V)?"Show GP Prediction":"Show Energy Function"),X(At,l(V)?"Showing actual energy function":"Showing Gaussian Process prediction")},[()=>F(l(M),l(P)).toFixed(2)],Et),tt("click",E,St),tt("click",Z,Mt),gt(yt,H),Vt()}export{re as component};
