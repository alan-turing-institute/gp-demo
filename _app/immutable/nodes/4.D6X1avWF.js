import{t as Te,a as me}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as Fe,aa as Ye,ab as Xe,a9 as $e,a5 as He,s as b,a6 as y,i as Le,e as i,ac as I,a1 as T,a7 as m,a8 as Oe}from"../chunks/BJ4irGt7.js";import{e as le,s as q}from"../chunks/CvaqDwXv.js";import{i as je}from"../chunks/lIaEYNz1.js";import{s as B}from"../chunks/B9r3SdpA.js";import{l as ne,s as qe,c as Be}from"../chunks/dhIx7U5O.js";import{b as ue}from"../chunks/CUY-1DrG.js";import{i as De}from"../chunks/CkfO92w8.js";import{o as Ke}from"../chunks/Cpzjerpz.js";import{r as D,s as Ne,v as Se,z as be,l as Ze,m as Je}from"../chunks/PBAI84v4.js";var Qe=Te('<button class="svelte-1p6hea8">Clear Samples</button>'),Ue=Te('<main class="svelte-1p6hea8"><h1 class="svelte-1p6hea8">Astroid with Velocity Vector Explorer</h1> <div class="container svelte-1p6hea8"><div class="panel svelte-1p6hea8"><h2 class="svelte-1p6hea8">Astroid Visualization</h2> <canvas class="svelte-1p6hea8"></canvas></div> <div class="panel svelte-1p6hea8"><h2 class="svelte-1p6hea8">Flyby distance past Earth</h2> <div class="contour-container svelte-1p6hea8"><canvas></canvas></div> <div class="info svelte-1p6hea8"><p class="svelte-1p6hea8"> </p> <p class="svelte-1p6hea8"> </p> <div class="instruction svelte-1p6hea8"><p class="highlight svelte-1p6hea8">Click on the plot above to add sample points and update the GP model</p></div> <div class="button-group svelte-1p6hea8"><!> <button class="info-button svelte-1p6hea8"> </button></div> <div class="energy-function svelte-1p6hea8"><h3 class="svelte-1p6hea8">About the Visualization:</h3> <p class="svelte-1p6hea8"> </p> <p class="svelte-1p6hea8">The energy function (flyby distance) represents the closest approach distance given an objectâ€™s hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p> <p class="svelte-1p6hea8">Click directly on the plot to add sample points and build a GP model that learns this landscape.</p></div></div></div></div></main>');function ht(xe,Pe){Fe(Pe,!1);const r={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let M=I(5e3),z=I(3),x=I([]),G=[],R=I(),w=I(),F=I(!1),Y=I(!1);const P=6371;function _e(e,c,s=398600.4418,t=6371){const o=Math.sqrt(1+Math.pow(c,2)*Math.pow(e,4)/Math.pow(s,2)),n=s*(o-1)/Math.pow(e,2);return n>=t?n:0}function L(e,c){return _e(c,e)}const v=400,p=400,l=40,K=v-2*l,X=ne().domain([5e3,5*P]).range([l,v-l]),$=ne().domain([3,20]).range([p-l,l]);let _=1/0,C=-1/0;function ke(){const c=D(5e3,5*P,(5*P-5e3)/50).toArray(),s=D(3,20,17/50).toArray();for(const t of c)for(const o of s){const n=L(t,o);_=Math.min(_,n),C=Math.max(C,n)}_=Math.floor(_*10)/10,C=Math.ceil(C*10)/10,console.log(`Energy range: ${_} to ${C}`)}function Ae(){T(x,[]),G=[],O()}function Me(e){if(i(F))return;const c=i(w).getBoundingClientRect(),s=e.clientX-c.left,t=e.clientY-c.top;if(s>=l&&s<=v-l&&t>=l&&t<=p-l){const o=X.invert(s),n=$.invert(t);T(M,o),T(z,n);const d=L(i(M),i(z));T(x,[...i(x),{angle:i(M),velocity:i(z),energy:d}]),ze(),N()}}function ze(){if(T(F,!0),i(x).length===0){T(F,!1);return}setTimeout(()=>{const e=i(x).map(a=>[a.angle,a.velocity]),c=i(x).map(a=>a.energy),s=(a,h)=>{const V=(a[0]-h[0])/1e4,g=(a[1]-h[1])/5;return Math.exp(-.5*(V*V+g*g))},t=e.length,o=be(t,t);for(let a=0;a<t;a++)for(let h=0;h<t;h++)o.set([a,h],s(e[a],e[h]));const n=.01;for(let a=0;a<t;a++)o.set([a,a],o.get([a,a])+n);const d=40,u=D(5e3,5*P,(5*P-5e3)/d).toArray(),k=D(3,20,17/d).toArray();G=[];for(const a of u)for(const h of k){const V=[a,h],g=be(1,t);for(let f=0;f<t;f++)g.set([0,f],s(V,e[f]));try{const f=Ze(o,c),E=Je(g,f).get([0,0]);G.push({angle:a,velocity:h,predicted:E})}catch(f){console.error("Error in GP calculation:",f)}}O(),T(F,!1)},50)}function O(){if(!i(w))return;const e=i(w).getContext("2d");e.clearRect(0,0,i(w).width,i(w).height);const c=Ne(Se).domain([C,_]).interpolator(Se);if(i(Y)){const t=K/80;for(let o=0;o<80;o++)for(let n=0;n<80;n++){const d=5e3+(5*P-5e3)*o/80,u=3+17*n/80,k=L(d,u),a=X(d),h=$(u);e.fillStyle=c(k),e.fillRect(a-t/2,h-t/2,t,t)}}else if(G.length===0){const t=K/80;for(let o=0;o<80;o++)for(let n=0;n<80;n++){const d=5e3+(5*P-5e3)*o/80,u=3+17*n/80,k=X(d),a=$(u);e.fillStyle=c(0),e.fillRect(k-t/2,a-t/2,t,t)}}else{const s=K/Math.sqrt(G.length);G.forEach(t=>{const o=X(t.angle),n=$(t.velocity);e.fillStyle=c(t.predicted),e.fillRect(o-s/2,n-s/2,s,s)})}we(e,c),e.strokeStyle=r.primary,e.lineWidth=2,e.beginPath(),e.moveTo(l,p-l),e.lineTo(v-l,p-l),e.moveTo(l,l),e.lineTo(l,p-l),e.stroke(),e.fillStyle=r.text,e.font="12px Arial, sans-serif",e.textAlign="center",e.fillText("5000",l,p-l+15),e.fillText(String(5*P),v-l,p-l+15),e.fillText("Impact parameter (km)",v/2,p-l+20),e.textAlign="right",e.fillText("3",l-10,p-l),e.fillText("20",l-10,l),e.save(),e.translate(l-15,p/2-25),e.rotate(-Math.PI/2),e.fillText("Velocity (km/s)",0,0),e.restore(),i(x).forEach(s=>{const t=X(s.angle),o=$(s.velocity),n=10,d=e.createRadialGradient(t,o,2,t,o,n);d.addColorStop(0,r.highlight),d.addColorStop(1,"rgba(106, 137, 204, 0)"),e.fillStyle=d,e.beginPath(),e.arc(t,o,n,0,2*Math.PI),e.fill(),e.fillStyle=r.accent,e.beginPath(),e.arc(t,o,6,0,2*Math.PI),e.fill(),e.strokeStyle=r.primary,e.lineWidth=1,e.stroke()})}function we(e,c){const t=p-2*l,o=v-l+20,n=l,d=100,u=t/d;for(let g=0;g<d;g++){const f=_+(C-_)*(d-g-1)/d;e.fillStyle=c(f),e.fillRect(o,n+g*u,20,u+1)}e.strokeStyle=r.text,e.lineWidth=1,e.strokeRect(o,n,20,t),e.fillStyle=r.text,e.font="14px Arial, sans-serif",e.textAlign="left";const k=5,a=n+t;e.beginPath(),e.moveTo(o,a),e.lineTo(o+20,a),e.stroke(),e.fillText(_.toFixed(1),o+20+k,a+5);const h=n;e.beginPath(),e.moveTo(o,h),e.lineTo(o+20,h),e.stroke(),e.fillText(C.toFixed(1),o+20+k,h+5);const V=n+t/2;e.beginPath(),e.moveTo(o,V),e.stroke(),e.save(),e.translate(o-25,n+t/2),e.rotate(Math.PI/2),e.textAlign="center",e.fillText("Flyby Distance (km)",0,-60),e.restore()}function N(){if(!i(R))return;const e=i(R).getContext("2d");e.clearRect(0,0,v,p);const t=ne().domain([5e3,5*P]).range([p-l-30,l])(i(M)),o=l*2;e.save(),e.setLineDash([5,5]),e.beginPath(),e.moveTo(0,t),e.lineTo(v,t),e.strokeStyle=r.error,e.lineWidth=1,e.stroke(),e.restore();const n=20,d=12,u=2*Math.PI/d;e.beginPath();for(let j=0;j<d;j++){const pe=j*u,Ge=.8+Math.random()*.4,ve=n*Ge,ge=o+ve*Math.cos(pe),ye=t+ve*Math.sin(pe);j===0?e.moveTo(ge,ye):e.lineTo(ge,ye)}e.closePath(),e.fillStyle=r.surface,e.fill(),e.strokeStyle=r.primary,e.lineWidth=2,e.stroke(),e.fillStyle=r.text,e.font="12px Arial",e.textAlign="center",e.fillText("Asteroid",o,t+n+15);const a=i(z)*10;e.beginPath(),e.moveTo(o,t),e.lineTo(o+a,t),e.strokeStyle=r.error,e.lineWidth=3,e.stroke();const h=8;e.beginPath(),e.moveTo(o+a,t),e.lineTo(o+a-h,t-h/2),e.lineTo(o+a-h,t+h/2),e.closePath(),e.fillStyle=r.error,e.fill();const V=o+a/2,g=t;e.fillStyle=r.text,e.font="12px Arial",e.textAlign="center",e.fillText("velocity",V+25,g-10);const f=20,E=v-l-f,S=p-l-f,ae=e.createRadialGradient(E,S,f*.3,E,S,f);ae.addColorStop(0,"#66ccff"),ae.addColorStop(1,"#003366"),e.beginPath(),e.arc(E,S,f,0,2*Math.PI),e.fillStyle=ae,e.fill(),e.strokeStyle="#002244",e.lineWidth=2,e.stroke(),e.beginPath(),e.moveTo(0,S),e.lineTo(v,S),e.strokeStyle=r.primary,e.lineWidth=2,e.stroke();const A=(o+E)/2;e.beginPath(),e.moveTo(A,t),e.lineTo(A,S),e.strokeStyle=r.text,e.lineWidth=1,e.stroke();const W=5;e.beginPath(),e.moveTo(A,t),e.lineTo(A-W,t+W),e.lineTo(A+W,t+W),e.closePath(),e.fillStyle=r.text,e.fill(),e.beginPath(),e.moveTo(A,S),e.lineTo(A-W,S-W),e.lineTo(A+W,S-W),e.closePath(),e.fillStyle=r.text,e.fill(),e.save(),e.fillStyle=r.text,e.font="12px Arial",e.textAlign="left",e.fillText("impact parameter",A+5,(t+S)/2),e.restore(),e.fillStyle=r.text,e.font="12px Arial",e.textAlign="center",e.fillText("Earth",E,S+f+15),e.fillStyle=r.text,e.font="14px Arial",e.textAlign="left",e.fillText(`Impact Parameter: ${i(M).toFixed(0)} km`,20,30),e.fillText(`Velocity: ${i(z).toFixed(2)} km/s`,20,50)}function Ce(){T(Y,!i(Y)),O()}Ke(()=>{console.log("Astroid canvas:",i(R)),console.log("Contour canvas:",i(w)),ke(),N(),O()}),Ye(()=>(i(R),i(M),i(z)),()=>{i(R)&&(i(M)!==void 0||i(z)!==void 0)&&N()}),Xe(),De();var Z=Ue(),se=b(y(Z),2),J=y(se),Q=b(y(J),2);B(Q,"width",v),B(Q,"height",p),ue(Q,e=>T(R,e),()=>i(R)),m(J);var re=b(J,2),U=b(y(re),2),H=y(U);B(H,"width",v+60),B(H,"height",p),ue(H,e=>T(w,e),()=>i(w)),m(U);var ce=b(U,2),ee=y(ce),Ve=y(ee);m(ee);var te=b(ee,2),We=y(te);m(te);var oe=b(te,4),de=y(oe);{var Re=e=>{var c=Qe();le("click",c,Ae),me(e,c)};je(de,e=>{i(x).length>0&&e(Re)})}var ie=b(de,2),Ee=y(ie,!0);m(ie),m(oe);var he=b(oe,2),fe=b(y(he),2),Ie=y(fe,!0);m(fe),Oe(4),m(he),m(ce),m(re),m(se),m(Z),$e(e=>{qe(H,1,Be(i(F)?"loading":""),"svelte-1p6hea8"),q(Ve,`Samples: ${i(x).length??""}`),q(We,`Current energy: ${e??""}`),q(Ee,i(Y)?"Show GP Prediction":"Show Energy Function"),q(Ie,i(Y)?"Showing actual energy function":"Showing Gaussian Process prediction")},[()=>L(i(M),i(z)).toFixed(2)],Le),le("click",H,Me),le("click",ie,Ce),me(xe,Z),He()}export{ht as component};
