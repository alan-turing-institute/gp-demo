import{t as pt,a as ft}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as oe,aa as wt,ab as ie,a9 as zt,a5 as se,s as m,a6 as h,i as Et,e as i,ac as P,a1 as v,a7 as g,a8 as le}from"../chunks/BJ4irGt7.js";import{e as B,s as Z}from"../chunks/CvaqDwXv.js";import{i as Rt}from"../chunks/lIaEYNz1.js";import{s as I}from"../chunks/B9r3SdpA.js";import{l as vt,s as ae,c as ne}from"../chunks/dhIx7U5O.js";import{b as Wt}from"../chunks/CUY-1DrG.js";import{i as re}from"../chunks/CkfO92w8.js";import{o as ce}from"../chunks/Cpzjerpz.js";import{r as J,s as de,v as Ct,z as Vt,l as fe,m as ve}from"../chunks/PBAI84v4.js";var pe=pt(`<div class="game-ended-popup svelte-9fpox1"><div class="popup-content svelte-9fpox1"><h2 class="svelte-9fpox1">Game Ended</h2> <p class="svelte-9fpox1">You've used all your lives!</p> <p class="svelte-9fpox1"> </p> <button class="svelte-9fpox1">Play Again</button></div></div>`),he=pt('<button class="svelte-9fpox1">Clear Samples</button>'),ge=pt('<main class="svelte-9fpox1"><h1 class="svelte-9fpox1">Asteroid Explorer</h1> <div class="live-bar-container svelte-9fpox1"><div class="lives-label svelte-9fpox1"> </div> <div class="live-bar svelte-9fpox1"><div class="lives-remaining svelte-9fpox1"></div> <span class="heart svelte-9fpox1">❤️</span></div></div> <div class="score-bar-container svelte-9fpox1"><div class="score-label svelte-9fpox1">Score: <span id="score-percentage"> </span></div> <div class="score-bar svelte-9fpox1"><div class="score-value svelte-9fpox1" id="score-bar"></div> <span class="star svelte-9fpox1" id="score-star">⭐</span></div></div> <!> <div class="container svelte-9fpox1"><div class="panel svelte-9fpox1"><h2 class="svelte-9fpox1">Asteroid Visualization</h2> <canvas class="svelte-9fpox1"></canvas> <div class="instruction svelte-9fpox1"><p class="svelte-9fpox1">Flyby distance is the closest approach distance given an object’s hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p></div></div> <div class="panel svelte-9fpox1"><h2 class="svelte-9fpox1">Flyby distance past Earth</h2> <div class="contour-container svelte-9fpox1"><canvas></canvas></div> <div class="instruction svelte-9fpox1"><p class="highlight svelte-9fpox1">Your goal is to train an emulator that accurately predicts flyby distance using as few asteroid simulator runs as possible.</p></div> <div class="button-group svelte-9fpox1"><!> <button class="info-button svelte-9fpox1"> </button></div> <div class="instruction svelte-9fpox1"><p class="svelte-9fpox1">Click directly on the plot above to sample points. This will run the simulation and update the emulator model based on the simulator output.</p></div> <div class="button-group svelte-9fpox1"><button class="info-button svelte-9fpox1"><span>Go back</span></button></div></div></div></main>');function Me(It,Ft){oe(Ft,!1);const E=P();function Gt(){window.location.href="https://alan-turing-institute.github.io/gp-demo/"}const d={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let F=P(5e3),G=P(3),A=P([]),$=[],Y=P(),R=P(),L=P(!1),D=P(!1),W=P(20),Q=P(!1);const M=6371;function $t(t,a,r=398600.4418,e=6371){const o=Math.sqrt(1+Math.pow(a,2)*Math.pow(t,4)/Math.pow(r,2)),s=r*(o-1)/Math.pow(t,2);return s>=e?s:0}function K(t,a){return $t(a,t)}const b=400,y=400,l=40,U=b-2*l,X=vt().domain([5e3,5*M]).range([l,b-l]),O=vt().domain([3,20]).range([y-l,l]);let w=1/0,C=-1/0;function Yt(){const a=J(5e3,5*M,(5*M-5e3)/50).toArray(),r=J(3,20,17/50).toArray();for(const e of a)for(const o of r){const s=K(e,o);w=Math.min(w,s),C=Math.max(C,s)}w=Math.floor(w*10)/10,C=Math.ceil(C*10)/10,console.log(`Energy range: ${w} to ${C}`)}function Ht(){v(A,[]),$=[],j(),v(W,20),v(E,0)}function Lt(t){if(i(L)||i(W)<=0)return;const a=i(R).getBoundingClientRect(),r=t.clientX-a.left,e=t.clientY-a.top;if(r>=l&&r<=b-l&&e>=l&&e<=y-l){const o=X.invert(r),s=O.invert(e);v(F,o),v(G,s);const n=K(i(F),i(G));v(A,[...i(A),{angle:i(F),velocity:i(G),energy:n}]),v(W,i(W)-1),i(W)===0&&v(Q,!0),jt(),tt()}}function Xt(){v(W,20),v(E,0),v(A,[]),$=[],v(Q,!1),j()}function Ot(t,a){if(t.length!==a.length||t.length===0)throw new Error("Arrays must be of the same length and non-empty");const r=t.reduce((n,u)=>n+u,0)/t.length,e=t.reduce((n,u)=>n+Math.pow(u-r,2),0),s=1-t.reduce((n,u,_)=>n+Math.pow(u-a[_],2),0)/e;return Math.max(0,s)}function jt(){v(L,!0);let t=[],a=[];if(i(A).length===0){v(L,!1);return}setTimeout(()=>{const r=i(A).map(c=>[c.angle,c.velocity]),e=i(A).map(c=>c.energy),o=(c,p)=>{const S=(c[0]-p[0])/1e4,k=(c[1]-p[1])/5;return Math.exp(-.5*(S*S+k*k))},s=r.length,n=Vt(s,s);for(let c=0;c<s;c++)for(let p=0;p<s;p++)n.set([c,p],o(r[c],r[p]));const u=.01;for(let c=0;c<s;c++)n.set([c,c],n.get([c,c])+u);const _=40,x=J(5e3,5*M,(5*M-5e3)/_).toArray(),T=J(3,20,17/_).toArray();$=[];for(const c of x)for(const p of T){const S=[c,p],k=Vt(1,s);for(let f=0;f<s;f++)k.set([0,f],o(S,r[f]));try{const f=fe(n,e),H=ve(k,f).get([0,0]);$.push({angle:c,velocity:p,predicted:H}),a.push(H),t.push(K(c,p))}catch(f){console.error("Error in GP calculation:",f)}}j(),v(E,Ot(t,a)),v(L,!1)},50)}function j(){if(!i(R))return;const t=i(R).getContext("2d");t.clearRect(0,0,i(R).width,i(R).height);const a=de(Ct).domain([C,w]).interpolator(Ct);if(i(D)){const e=U/80;for(let o=0;o<80;o++)for(let s=0;s<80;s++){const n=5e3+(5*M-5e3)*o/80,u=3+17*s/80,_=K(n,u),x=X(n),T=O(u);t.fillStyle=a(_),t.fillRect(x-e/2,T-e/2,e,e)}}else if($.length===0){const e=U/80;for(let o=0;o<80;o++)for(let s=0;s<80;s++){const n=5e3+(5*M-5e3)*o/80,u=3+17*s/80,_=X(n),x=O(u);t.fillStyle=a(0),t.fillRect(_-e/2,x-e/2,e,e)}}else{const r=U/Math.sqrt($.length);$.forEach(e=>{const o=X(e.angle),s=O(e.velocity);t.fillStyle=a(e.predicted),t.fillRect(o-r/2,s-r/2,r,r)})}qt(t,a),t.strokeStyle=d.primary,t.lineWidth=2,t.beginPath(),t.moveTo(l,y-l),t.lineTo(b-l,y-l),t.moveTo(l,l),t.lineTo(l,y-l),t.stroke(),t.fillStyle=d.text,t.font="12px Arial, sans-serif",t.textAlign="center",t.fillText("5000",l,y-l+15),t.fillText(String(5*M),b-l,y-l+15),t.fillText("Impact parameter (km)",b/2,y-l+20),t.textAlign="right",t.fillText("3",l-10,y-l),t.fillText("20",l-10,l),t.save(),t.translate(l-15,y/2-25),t.rotate(-Math.PI/2),t.fillText("Velocity (km/s)",0,0),t.restore(),i(A).forEach(r=>{const e=X(r.angle),o=O(r.velocity),s=10,n=t.createRadialGradient(e,o,2,e,o,s);n.addColorStop(0,d.highlight),n.addColorStop(1,"rgba(106, 137, 204, 0)"),t.fillStyle=n,t.beginPath(),t.arc(e,o,s,0,2*Math.PI),t.fill(),t.fillStyle=d.accent,t.beginPath(),t.arc(e,o,6,0,2*Math.PI),t.fill(),t.strokeStyle=d.primary,t.lineWidth=1,t.stroke()})}function qt(t,a){const e=y-2*l,o=b-l+20,s=l,n=100,u=e/n;for(let p=0;p<n;p++){const S=w+(C-w)*(n-p-1)/n;t.fillStyle=a(S),t.fillRect(o,s+p*u,20,u+1)}t.strokeStyle=d.text,t.lineWidth=1,t.strokeRect(o,s,20,e),t.fillStyle=d.text,t.font="14px Arial, sans-serif",t.textAlign="left";const _=5,x=s+e;t.beginPath(),t.moveTo(o,x),t.lineTo(o+20,x),t.stroke(),t.fillText(w.toFixed(1),o+20+_,x+5);const T=s;t.beginPath(),t.moveTo(o,T),t.lineTo(o+20,T),t.stroke(),t.fillText(C.toFixed(1),o+20+_,T+5);const c=s+e/2;t.beginPath(),t.moveTo(o,c),t.stroke(),t.save(),t.translate(o-25,s+e/2),t.rotate(Math.PI/2),t.textAlign="center",t.fillText("Flyby Distance (km)",0,-60),t.restore()}function tt(){if(!i(Y))return;const t=i(Y).getContext("2d");t.clearRect(0,0,b,y);const e=vt().domain([5e3,5*M]).range([y-l-30,l])(i(F)),o=l*2;t.save(),t.setLineDash([5,5]),t.beginPath(),t.moveTo(0,e),t.lineTo(b,e),t.strokeStyle=d.error,t.lineWidth=1,t.stroke(),t.restore();const s=20,n=12,u=2*Math.PI/n;t.beginPath();for(let N=0;N<n;N++){const kt=N*u,ee=.8+Math.random()*.4,Pt=s*ee,At=o+Pt*Math.cos(kt),Mt=e+Pt*Math.sin(kt);N===0?t.moveTo(At,Mt):t.lineTo(At,Mt)}t.closePath(),t.fillStyle=d.surface,t.fill(),t.strokeStyle=d.primary,t.lineWidth=2,t.stroke(),t.fillStyle=d.text,t.font="12px Arial",t.textAlign="center",t.fillText("Asteroid",o,e+s+15);const x=i(G)*10;t.beginPath(),t.moveTo(o,e),t.lineTo(o+x,e),t.strokeStyle=d.error,t.lineWidth=3,t.stroke();const T=8;t.beginPath(),t.moveTo(o+x,e),t.lineTo(o+x-T,e-T/2),t.lineTo(o+x-T,e+T/2),t.closePath(),t.fillStyle=d.error,t.fill();const c=o+x/2,p=e;t.fillStyle=d.text,t.font="12px Arial",t.textAlign="center",t.fillText("velocity",c+25,p-10);const S=20,k=b-l-S,f=y-l-S,H=t.createRadialGradient(k,f,S*.3,k,f,S);H.addColorStop(0,"#66ccff"),H.addColorStop(1,"#003366"),t.beginPath(),t.arc(k,f,S,0,2*Math.PI),t.fillStyle=H,t.fill(),t.strokeStyle="#002244",t.lineWidth=2,t.stroke(),t.beginPath(),t.moveTo(0,f),t.lineTo(b,f),t.strokeStyle=d.primary,t.lineWidth=2,t.stroke();const z=(o+k)/2;t.beginPath(),t.moveTo(z,e),t.lineTo(z,f),t.strokeStyle=d.text,t.lineWidth=1,t.stroke();const V=5;t.beginPath(),t.moveTo(z,e),t.lineTo(z-V,e+V),t.lineTo(z+V,e+V),t.closePath(),t.fillStyle=d.text,t.fill(),t.beginPath(),t.moveTo(z,f),t.lineTo(z-V,f-V),t.lineTo(z+V,f-V),t.closePath(),t.fillStyle=d.text,t.fill(),t.save(),t.fillStyle=d.text,t.font="12px Arial",t.textAlign="left",t.fillText("impact parameter",z+5,(e+f)/2),t.restore(),t.fillStyle=d.text,t.font="12px Arial",t.textAlign="center",t.fillText("Earth",k,f+S+15),t.fillStyle=d.text,t.font="14px Arial",t.textAlign="left",t.fillText(`Impact Parameter: ${i(F).toFixed(0)} km`,20,30),t.fillText(`Velocity: ${i(G).toFixed(2)} km/s`,20,50)}function Bt(){v(D,!i(D)),j()}ce(()=>{console.log("Astroid canvas:",i(Y)),console.log("Contour canvas:",i(R)),Yt(),tt(),j()}),wt(()=>{},()=>{v(E,0)}),wt(()=>(i(Y),i(F),i(G)),()=>{i(Y)&&(i(F)!==void 0||i(G)!==void 0)&&tt()}),ie(),re();var et=ge(),ot=m(h(et),2),it=h(ot),Dt=h(it);g(it);var ht=m(it,2),gt=h(ht),Kt=m(gt,2);g(ht),g(ot);var st=m(ot,2),lt=h(st),ut=m(h(lt)),Nt=h(ut);g(ut),g(lt);var mt=m(lt,2),yt=h(mt),Zt=m(yt,2);g(mt),g(st);var xt=m(st,2);{var Jt=t=>{var a=pe(),r=h(a),e=m(h(r),4),o=h(e);g(e);var s=m(e,2);g(r),g(a),zt(n=>Z(o,`Final score: ${n??""}%`),[()=>(i(E)*100).toFixed(0)],Et),B("click",s,Xt),ft(t,a)};Rt(xt,t=>{i(Q)&&t(Jt)})}var bt=m(xt,2),at=h(bt),nt=m(h(at),2);I(nt,"width",b),I(nt,"height",y),Wt(nt,t=>v(Y,t),()=>i(Y)),le(2),g(at);var St=m(at,2),rt=m(h(St),2),q=h(rt);I(q,"width",b+60),I(q,"height",y),Wt(q,t=>v(R,t),()=>i(R)),g(rt);var ct=m(rt,4),_t=h(ct);{var Qt=t=>{var a=he();B("click",a,Ht),ft(t,a)};Rt(_t,t=>{i(A).length>0&&t(Qt)})}var dt=m(_t,2),Ut=h(dt,!0);g(dt),g(ct);var Tt=m(ct,4),te=h(Tt);g(Tt),g(St),g(bt),g(et),zt((t,a)=>{Z(Dt,`Lives ${i(W)??""}/20`),I(gt,"style",`width: ${t??""}%`),I(Kt,"style",`left: ${t??""}%`),Z(Nt,`${a??""}%`),I(yt,"style",`width: ${i(E)*100}%`),I(Zt,"style",`left: ${i(E)*100}%`),ae(q,1,ne(i(L)?"loading":""),"svelte-9fpox1"),Z(Ut,i(D)?"Show Emulator Prediction":"Show Simulator Function")},[()=>Math.max(0,i(W)/20*100),()=>(i(E)*100).toFixed(0)],Et),B("click",q,Lt),B("click",dt,Bt),B("click",te,Gt),ft(It,et),se()}export{Me as component};
