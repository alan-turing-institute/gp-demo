import{t as q,a as j}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as se,aa as Ct,ab as ie,a9 as tt,a5 as ae,s as g,a6 as h,i as Rt,e as i,ac as P,a1 as b,a7 as f,f as Wt,a8 as le}from"../chunks/BJ4irGt7.js";import{e as G,s as U}from"../chunks/CvaqDwXv.js";import{i as et}from"../chunks/lIaEYNz1.js";import{s as k}from"../chunks/B9r3SdpA.js";import{l as ft,s as pt,c as Vt}from"../chunks/dhIx7U5O.js";import{b as st}from"../chunks/CUY-1DrG.js";import{i as oe}from"../chunks/CkfO92w8.js";import{o as Ft}from"../chunks/Cpzjerpz.js";import{r as it,s as ne,v as It,z as Gt,l as re,m as ce}from"../chunks/PBAI84v4.js";var ve=q('<div class="game-ended-popup svelte-1v2s6zb"><div class="popup-content svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Game Ended</h2> <p class="svelte-1v2s6zb">You have used all your budget!</p> <p class="svelte-1v2s6zb"> </p> <button class="svelte-1v2s6zb">Play Again</button></div></div>'),de=q('<button class="svelte-1v2s6zb">Clear Samples</button>'),he=q('<div class="panel svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Asteroid Visualization</h2> <canvas class="svelte-1v2s6zb"></canvas></div> <div class="panel svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Flyby distance past Earth</h2> <div class="contour-container svelte-1v2s6zb"><canvas></canvas></div> <div class="button-group svelte-1v2s6zb"><!> <button class="info-button svelte-1v2s6zb"> </button></div> <div class="side_instruction svelte-1v2s6zb"><p class="svelte-1v2s6zb">Click directly on the plot</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Sample points with velocity and impact factor</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Run the simulation</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Update the emulator model</p></div></div>',1),fe=q('<button class="svelte-1v2s6zb">Clear Samples</button>'),pe=q('<div class="grid-item energy-plot svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Flyby distance past Earth</h2> <div class="contour-container svelte-1v2s6zb"><canvas></canvas></div></div> <div class="grid-item buttons svelte-1v2s6zb"><div class="side_instruction svelte-1v2s6zb"><p class="svelte-1v2s6zb">Click directly on the plot</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Sample points with velocity and impact factor</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Run the simulation</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Update the emulator model</p></div> <div class="vertical-button-group svelte-1v2s6zb"><!> <button class="info-button svelte-1v2s6zb"> </button></div></div> <div class="grid-item molecule-panel svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Asteroid Visualization</h2> <canvas class="svelte-1v2s6zb"></canvas></div>',1),ge=q('<main class="svelte-1v2s6zb"><h1 style="display: inline-flex; align-items: center; font-size: 3rem;" class="svelte-1v2s6zb"><img src="https://raw.githubusercontent.com/alan-turing-institute/gp-demo/refs/heads/main/static/asteroid.png" alt="Asteroid Explorer Icon" style="width: 80px; height: 80px; margin-right: 15px; border-radius: 0; box-shadow: none;" class="svelte-1v2s6zb"> Asteroid Explorer</h1> <div class="instruction svelte-1v2s6zb"><p class="svelte-1v2s6zb">Calculating the trajectory of celestial bodies like asteroids or comets approaching Earth is costly and time-consuming due to gravitational interactions, relativistic effects, and observational uncertainties. Training an emulator offers a cheaper and sufficiently accurate alternative.</p> <p class="svelte-1v2s6zb">üíª Lets train an emulator that can predict if an asteroid will coloide with the Earth.</p> <p class="svelte-1v2s6zb">üí∑ You have a budget to run 20 simulations to train your emulator.</p> <p class="svelte-1v2s6zb">üìê Adjust the velocity and the impact parameter to explore the Flyby distance map.</p></div> <div class="bars-container svelte-1v2s6zb"><div class="live-bar-container svelte-1v2s6zb"><div class="lives-label"> </div> <div class="live-bar svelte-1v2s6zb"><div class="lives-remaining svelte-1v2s6zb"></div> <span class="heart svelte-1v2s6zb">üí∑</span></div></div> <div></div> <div class="score-bar-container svelte-1v2s6zb"><div class="score-label">Score: <span id="score-percentage"> </span></div> <div class="score-bar svelte-1v2s6zb"><div class="score-value svelte-1v2s6zb" id="score-bar"></div> <span class="star svelte-1v2s6zb" id="score-star">‚≠ê</span></div></div></div> <!> <div><!></div> <div class="button-group svelte-1v2s6zb" style="margin-top: 20px; text-align: center;"><button class="info-button svelte-1v2s6zb"><span>Go back</span></button></div></main>');function Pe(Yt,$t){se($t,!1);const W=P();function Lt(){window.location.href="https://alan-turing-institute.github.io/gp-demo/"}const u={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let Y=P(5e3),$=P(3),A=P([]),L=[],M=P(),T=P(),H=P(!1),B=P(!1),V=P(20),at=P(!1);const E=6371;let lt=P(!1);function ot(){b(lt,window.innerHeight>window.innerWidth)}Ft(()=>(gt(),Z(),setTimeout(()=>{X()},100),ot(),window.addEventListener("resize",ot),()=>{window.removeEventListener("resize",ot)}));function Ht(t,o,n=398600.4418,e=6371){const s=Math.sqrt(1+Math.pow(o,2)*Math.pow(t,4)/Math.pow(n,2)),a=n*(s-1)/Math.pow(t,2);return a>=e?a:0}function N(t,o){return Ht(o,t)}const x=400,S=400,r=40,nt=x-2*r,D=ft().domain([5e3,5*E]).range([r,x-r]),K=ft().domain([3,20]).range([S-r,r]);let C=1/0,F=-1/0;function gt(){const o=it(5e3,5*E,(5*E-5e3)/50).toArray(),n=it(3,20,17/50).toArray();for(const e of o)for(const s of n){const a=N(e,s);C=Math.min(C,a),F=Math.max(F,a)}C=Math.floor(C*10)/10,F=Math.ceil(F*10)/10,console.log(`Energy range: ${C} to ${F}`)}function bt(){b(A,[]),L=[],X(),b(V,20),b(W,0)}function ut(t){if(i(H)||i(V)<=0)return;const o=i(T).getBoundingClientRect(),n=i(T).width/o.width,e=i(T).height/o.height,s=(t.clientX-o.left)*n,a=(t.clientY-o.top)*e;if(s>=r&&s<=x-r&&a>=r&&a<=S-r){const l=D.invert(s),d=K.invert(a);b(Y,l),b($,d);const z=N(i(Y),i($));b(A,[...i(A),{angle:i(Y),velocity:i($),energy:z}]),b(V,i(V)-1),i(V)===0&&b(at,!0),jt(),Z()}}function Xt(){b(V,20),b(W,0),b(A,[]),L=[],b(at,!1),X()}function Ot(t,o){if(t.length!==o.length||t.length===0)throw new Error("Arrays must be of the same length and non-empty");const n=t.reduce((l,d)=>l+d,0)/t.length,e=t.reduce((l,d)=>l+Math.pow(d-n,2),0),a=1-t.reduce((l,d,z)=>l+Math.pow(d-o[z],2),0)/e;return Math.max(0,a)}function jt(){b(H,!0);let t=[],o=[];if(i(A).length===0){b(H,!1);return}setTimeout(()=>{const n=i(A).map(c=>[c.angle,c.velocity]),e=i(A).map(c=>c.energy),s=(c,v)=>{const p=(c[0]-v[0])/1e4,w=(c[1]-v[1])/5;return Math.exp(-.5*(p*p+w*w))},a=n.length,l=Gt(a,a);for(let c=0;c<a;c++)for(let v=0;v<a;v++)l.set([c,v],s(n[c],n[v]));const d=.01;for(let c=0;c<a;c++)l.set([c,c],l.get([c,c])+d);const z=40,m=it(5e3,5*E,(5*E-5e3)/z).toArray(),_=it(3,20,17/z).toArray();L=[];for(const c of m)for(const v of _){const p=[c,v],w=Gt(1,a);for(let y=0;y<a;y++)w.set([0,y],s(p,n[y]));try{const y=re(l,e),O=ce(w,y).get([0,0]);L.push({angle:c,velocity:v,predicted:O}),o.push(O),t.push(N(c,v))}catch(y){console.error("Error in GP calculation:",y)}}X(),b(W,Ot(t,o)),b(H,!1)},50)}function X(){if(!i(T))return;const t=i(T).getContext("2d");t.clearRect(0,0,i(T).width,i(T).height);const o=ne(It).domain([F,C]).interpolator(It);if(i(B)){const e=nt/80;for(let s=0;s<80;s++)for(let a=0;a<80;a++){const l=5e3+(5*E-5e3)*s/80,d=3+17*a/80,z=N(l,d),m=D(l),_=K(d);t.fillStyle=o(z),t.fillRect(m-e/2,_-e/2,e,e)}}else if(L.length===0){const e=nt/80;for(let s=0;s<80;s++)for(let a=0;a<80;a++){const l=5e3+(5*E-5e3)*s/80,d=3+17*a/80,z=D(l),m=K(d);t.fillStyle=o(0),t.fillRect(z-e/2,m-e/2,e,e)}}else{const n=nt/Math.sqrt(L.length);L.forEach(e=>{const s=D(e.angle),a=K(e.velocity);t.fillStyle=o(e.predicted),t.fillRect(s-n/2,a-n/2,n,n)})}qt(t,o),t.strokeStyle=u.primary,t.lineWidth=2,t.beginPath(),t.moveTo(r,S-r),t.lineTo(x-r,S-r),t.moveTo(r,r),t.lineTo(r,S-r),t.stroke(),t.fillStyle=u.text,t.font="12px Arial, sans-serif",t.textAlign="center",t.fillText("5000",r,S-r+15),t.fillText(String(5*E),x-r,S-r+15),t.fillText("Impact parameter (km)",x/2,S-r+20),t.textAlign="right",t.fillText("3",r-10,S-r),t.fillText("20",r-10,r),t.save(),t.translate(r-15,S/2-25),t.rotate(-Math.PI/2),t.fillText("Velocity (km/s)",0,0),t.restore(),i(A).forEach(n=>{const e=D(n.angle),s=K(n.velocity),a=10,l=t.createRadialGradient(e,s,2,e,s,a);l.addColorStop(0,u.highlight),l.addColorStop(1,"rgba(106, 137, 204, 0)"),t.fillStyle=l,t.beginPath(),t.arc(e,s,a,0,2*Math.PI),t.fill(),t.fillStyle=u.accent,t.beginPath(),t.arc(e,s,6,0,2*Math.PI),t.fill(),t.strokeStyle=u.primary,t.lineWidth=1,t.stroke()})}function qt(t,o){const e=S-2*r,s=x-r+20,a=r,l=100,d=e/l;for(let v=0;v<l;v++){const p=C+(F-C)*(l-v-1)/l;t.fillStyle=o(p),t.fillRect(s,a+v*d,20,d+1)}t.strokeStyle=u.text,t.lineWidth=1,t.strokeRect(s,a,20,e),t.fillStyle=u.text,t.font="14px Arial, sans-serif",t.textAlign="left";const z=5,m=a+e;t.beginPath(),t.moveTo(s,m),t.lineTo(s+20,m),t.stroke(),t.fillText(C.toFixed(1),s+20+z,m+5);const _=a;t.beginPath(),t.moveTo(s,_),t.lineTo(s+20,_),t.stroke(),t.fillText(F.toFixed(1),s+20+z,_+5);const c=a+e/2;t.beginPath(),t.moveTo(s,c),t.stroke(),t.save(),t.translate(s-25,a+e/2),t.rotate(Math.PI/2),t.textAlign="center",t.fillText("Flyby Distance (km)",0,-60),t.restore()}function Z(){if(!i(M))return;const t=i(M).getContext("2d");t.clearRect(0,0,x,S);const e=ft().domain([5e3,5*E]).range([S-r-30,r])(i(Y)),s=r*2;t.save(),t.setLineDash([5,5]),t.beginPath(),t.moveTo(0,e),t.lineTo(x,e),t.strokeStyle=u.error,t.lineWidth=1,t.stroke(),t.restore();const a=20,l=12,d=2*Math.PI/l;t.beginPath();for(let Q=0;Q<l;Q++){const Pt=Q*d,ee=.8+Math.random()*.4,At=a*ee,Mt=s+At*Math.cos(Pt),Et=e+At*Math.sin(Pt);Q===0?t.moveTo(Mt,Et):t.lineTo(Mt,Et)}t.closePath(),t.fillStyle=u.surface,t.fill(),t.strokeStyle=u.primary,t.lineWidth=2,t.stroke(),t.fillStyle=u.text,t.font="12px Arial",t.textAlign="center",t.fillText("Asteroid",s,e+a+15);const m=i($)*10;t.beginPath(),t.moveTo(s,e),t.lineTo(s+m,e),t.strokeStyle=u.error,t.lineWidth=3,t.stroke();const _=8;t.beginPath(),t.moveTo(s+m,e),t.lineTo(s+m-_,e-_/2),t.lineTo(s+m-_,e+_/2),t.closePath(),t.fillStyle=u.error,t.fill();const c=s+m/2,v=e;t.fillStyle=u.text,t.font="12px Arial",t.textAlign="center",t.fillText("velocity",c+25,v-10);const p=20,w=x-r-p,y=S-r-p,O=t.createRadialGradient(w,y,p*.3,w,y,p);O.addColorStop(0,"#66ccff"),O.addColorStop(1,"#003366"),t.beginPath(),t.arc(w,y,p,0,2*Math.PI),t.fillStyle=O,t.fill(),t.strokeStyle="#002244",t.lineWidth=2,t.stroke(),t.beginPath(),t.moveTo(0,y),t.lineTo(x,y),t.strokeStyle=u.primary,t.lineWidth=2,t.stroke();const R=(s+w)/2;t.beginPath(),t.moveTo(R,e),t.lineTo(R,y),t.strokeStyle=u.text,t.lineWidth=1,t.stroke();const I=5;t.beginPath(),t.moveTo(R,e),t.lineTo(R-I,e+I),t.lineTo(R+I,e+I),t.closePath(),t.fillStyle=u.text,t.fill(),t.beginPath(),t.moveTo(R,y),t.lineTo(R-I,y-I),t.lineTo(R+I,y-I),t.closePath(),t.fillStyle=u.text,t.fill(),t.save(),t.fillStyle=u.text,t.font="12px Arial",t.textAlign="left",t.fillText("impact parameter",R+5,(e+y)/2),t.restore(),t.fillStyle=u.text,t.font="12px Arial",t.textAlign="center",t.fillText("Earth",w,y+p+15),t.fillStyle=u.text,t.font="14px Arial",t.textAlign="left",t.fillText(`Impact Parameter: ${i(Y).toFixed(0)} km`,20,30),t.fillText(`Velocity: ${i($).toFixed(2)} km/s`,20,50)}function mt(){b(B,!i(B)),X()}Ft(()=>{console.log("Astroid canvas:",i(M)),console.log("Contour canvas:",i(T)),gt(),Z(),X()}),Ct(()=>{},()=>{b(W,0)}),Ct(()=>(i(M),i(Y),i($)),()=>{i(M)&&(i(Y)!==void 0||i($)!==void 0)&&Z()}),ie(),oe();var rt=ge(),ct=g(h(rt),4),vt=h(ct),dt=h(vt),Bt=h(dt);f(dt);var yt=g(dt,2),zt=h(yt),Dt=g(zt,2);f(yt),f(vt);var St=g(vt,4),ht=h(St),_t=g(h(ht)),Kt=h(_t);f(_t),f(ht);var xt=g(ht,2),wt=h(xt),Ut=g(wt,2);f(xt),f(St),f(ct);var Tt=g(ct,2);{var Nt=t=>{var o=ve(),n=h(o),e=g(h(n),4),s=h(e);f(e);var a=g(e,2);f(n),f(o),tt(l=>U(s,`Final score: ${l??""}%`),[()=>(i(W)*100).toFixed(0)],Rt),G("click",a,Xt),j(t,o)};et(Tt,t=>{i(at)&&t(Nt)})}var J=g(Tt,2),Zt=h(J);{var Jt=t=>{var o=he(),n=Wt(o),e=g(h(n),2);k(e,"width",x),k(e,"height",S),st(e,v=>b(M,v),()=>i(M)),f(n);var s=g(n,2),a=g(h(s),2),l=h(a);k(l,"width",x+60),k(l,"height",S),st(l,v=>b(T,v),()=>i(T)),f(a);var d=g(a,2),z=h(d);{var m=v=>{var p=de();G("click",p,bt),j(v,p)};et(z,v=>{i(A).length>0&&v(m)})}var _=g(z,2),c=h(_,!0);f(_),f(d),le(2),f(s),tt(()=>{pt(l,1,Vt(i(H)?"loading":""),"svelte-1v2s6zb"),U(c,i(B)?"Show Emulator Prediction":"Show Simulator Function")}),G("click",l,ut),G("click",_,mt),j(t,o)},Qt=t=>{var o=pe(),n=Wt(o),e=g(h(n),2),s=h(e);k(s,"width",x+60),k(s,"height",S),st(s,p=>b(T,p),()=>i(T)),f(e),f(n);var a=g(n,2),l=g(h(a),2),d=h(l);{var z=p=>{var w=fe();G("click",w,bt),j(p,w)};et(d,p=>{i(A).length>0&&p(z)})}var m=g(d,2),_=h(m,!0);f(m),f(l),f(a);var c=g(a,2),v=g(h(c),2);k(v,"width",x),k(v,"height",S),st(v,p=>b(M,p),()=>i(M)),f(c),tt(()=>{pt(s,1,Vt(i(H)?"loading":""),"svelte-1v2s6zb"),U(_,i(B)?"Show Emulator Prediction":"Show Simulator Function")}),G("click",s,ut),G("click",m,mt),j(t,o)};et(Zt,t=>{i(lt)?t(Qt,!1):t(Jt)})}f(J);var kt=g(J,2),te=h(kt);f(kt),f(rt),tt((t,o)=>{U(Bt,`Budget left ${i(V)??""}/20`),k(zt,"style",`width: ${t??""}%`),k(Dt,"style",`left: ${t??""}%`),U(Kt,`${o??""}%`),k(wt,"style",`width: ${i(W)*100}%`),k(Ut,"style",`left: ${i(W)*100}%`),pt(J,1,`responsive-grid ${(i(lt)?"vertical":"horizontal")??""}`,"svelte-1v2s6zb")},[()=>Math.max(0,i(V)/20*100),()=>(i(W)*100).toFixed(0)],Rt),G("click",te,Lt),j(Yt,rt),ae()}export{Pe as component};
