import{t as ge,a as fe}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as nt,aa as Ce,ab as rt,a9 as Re,a5 as ct,s as g,a6 as v,i as We,e as o,ac as P,a1 as h,a7 as p,a8 as dt}from"../chunks/BJ4irGt7.js";import{e as K,s as L}from"../chunks/CvaqDwXv.js";import{i as Ve}from"../chunks/lIaEYNz1.js";import{s as $}from"../chunks/B9r3SdpA.js";import{l as he,s as vt,c as pt}from"../chunks/dhIx7U5O.js";import{b as Ie}from"../chunks/CUY-1DrG.js";import{i as ft}from"../chunks/CkfO92w8.js";import{o as ht}from"../chunks/Cpzjerpz.js";import{r as J,s as gt,v as Fe,z as $e,l as mt,m as ut}from"../chunks/PBAI84v4.js";var yt=ge(`<div class="game-ended-popup svelte-1wpxoc7"><div class="popup-content svelte-1wpxoc7"><h2 class="svelte-1wpxoc7">Game Ended</h2> <p class="svelte-1wpxoc7">You've used all your lives!</p> <p class="svelte-1wpxoc7"> </p> <button class="svelte-1wpxoc7">Play Again</button></div></div>`),xt=ge('<button class="svelte-1wpxoc7">Clear Samples</button>'),bt=ge('<main class="svelte-1wpxoc7"><div class="header-container svelte-1wpxoc7"><h1 class="svelte-1wpxoc7">Asteroid Explorer</h1> <button class="home-button svelte-1wpxoc7"><span>Home</span></button></div> <div class="live-bar-container svelte-1wpxoc7"><div class="lives-label svelte-1wpxoc7"> </div> <div class="live-bar svelte-1wpxoc7"><div class="lives-remaining svelte-1wpxoc7"></div> <span class="heart svelte-1wpxoc7">❤️</span></div></div> <div class="score-bar-container svelte-1wpxoc7"><div class="score-label svelte-1wpxoc7">Score: <span id="score-percentage"> </span></div> <div class="score-bar svelte-1wpxoc7"><div class="score-value svelte-1wpxoc7" id="score-bar"></div> <span class="star svelte-1wpxoc7" id="score-star">⭐</span></div></div> <!> <div class="container svelte-1wpxoc7"><div class="panel svelte-1wpxoc7"><h2 class="svelte-1wpxoc7">Asteroid Visualization</h2> <canvas class="svelte-1wpxoc7"></canvas></div> <div class="panel svelte-1wpxoc7"><h2 class="svelte-1wpxoc7">Flyby distance past Earth</h2> <div class="contour-container svelte-1wpxoc7"><canvas></canvas></div> <div class="info svelte-1wpxoc7"><p class="svelte-1wpxoc7"> </p> <p class="svelte-1wpxoc7"> </p> <div class="instruction svelte-1wpxoc7"><p class="highlight svelte-1wpxoc7">Your goal is to train an accurate emulator using as few simulator runs as possible.</p> <p class="svelte-1wpxoc7">Click directly on the plot above to sample points. This will run the simulation and update the emulator model based on the simulator output.</p></div> <div class="button-group svelte-1wpxoc7"><!> <button class="info-button svelte-1wpxoc7"> </button></div> <div class="energy-function svelte-1wpxoc7"><h3 class="svelte-1wpxoc7">About the Visualization:</h3> <p class="svelte-1wpxoc7">The flyby distance is the closest approach distance given an object’s hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p></div></div></div></div></main>');function Rt(Ge,Ye){nt(Ye,!1);const E=P();function He(){window.location.href="https://alan-turing-institute.github.io/gp-demo/"}const d={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let C=P(5e3),R=P(3),k=P([]),G=[],Y=P(),W=P(),X=P(!1),N=P(!1),V=P(20),Q=P(!1);const A=6371;function Le(e,n,a=398600.4418,t=6371){const i=Math.sqrt(1+Math.pow(n,2)*Math.pow(e,4)/Math.pow(a,2)),s=a*(i-1)/Math.pow(e,2);return s>=t?s:0}function O(e,n){return Le(n,e)}const b=400,y=400,l=40,U=b-2*l,j=he().domain([5e3,5*A]).range([l,b-l]),q=he().domain([3,20]).range([y-l,l]);let M=1/0,I=-1/0;function Xe(){const n=J(5e3,5*A,(5*A-5e3)/50).toArray(),a=J(3,20,17/50).toArray();for(const t of n)for(const i of a){const s=O(t,i);M=Math.min(M,s),I=Math.max(I,s)}M=Math.floor(M*10)/10,I=Math.ceil(I*10)/10,console.log(`Energy range: ${M} to ${I}`)}function Oe(){h(k,[]),G=[],B(),h(V,20),h(E,0)}function je(e){if(o(X)||o(V)<=0)return;const n=o(W).getBoundingClientRect(),a=e.clientX-n.left,t=e.clientY-n.top;if(a>=l&&a<=b-l&&t>=l&&t<=y-l){const i=j.invert(a),s=q.invert(t);h(C,i),h(R,s);const r=O(o(C),o(R));h(k,[...o(k),{angle:o(C),velocity:o(R),energy:r}]),h(V,o(V)-1),o(V)===0&&h(Q,!0),De(),ee()}}function qe(){h(V,20),h(E,0),h(k,[]),G=[],h(Q,!1),B()}function Be(e,n){if(e.length!==n.length||e.length===0)throw new Error("Arrays must be of the same length and non-empty");const a=e.reduce((r,u)=>r+u,0)/e.length,t=e.reduce((r,u)=>r+Math.pow(u-a,2),0),s=1-e.reduce((r,u,w)=>r+Math.pow(u-n[w],2),0)/t;return Math.max(0,s)}function De(){h(X,!0);let e=[],n=[];if(o(k).length===0){h(X,!1);return}setTimeout(()=>{const a=o(k).map(c=>[c.angle,c.velocity]),t=o(k).map(c=>c.energy),i=(c,m)=>{const S=(c[0]-m[0])/1e4,T=(c[1]-m[1])/5;return Math.exp(-.5*(S*S+T*T))},s=a.length,r=$e(s,s);for(let c=0;c<s;c++)for(let m=0;m<s;m++)r.set([c,m],i(a[c],a[m]));const u=.01;for(let c=0;c<s;c++)r.set([c,c],r.get([c,c])+u);const w=40,x=J(5e3,5*A,(5*A-5e3)/w).toArray(),_=J(3,20,17/w).toArray();G=[];for(const c of x)for(const m of _){const S=[c,m],T=$e(1,s);for(let f=0;f<s;f++)T.set([0,f],i(S,a[f]));try{const f=mt(r,t),H=ut(T,f).get([0,0]);G.push({angle:c,velocity:m,predicted:H}),n.push(H),e.push(O(c,m))}catch(f){console.error("Error in GP calculation:",f)}}B(),h(E,Be(e,n)),h(X,!1)},50)}function B(){if(!o(W))return;const e=o(W).getContext("2d");e.clearRect(0,0,o(W).width,o(W).height);const n=gt(Fe).domain([I,M]).interpolator(Fe);if(o(N)){const t=U/80;for(let i=0;i<80;i++)for(let s=0;s<80;s++){const r=5e3+(5*A-5e3)*i/80,u=3+17*s/80,w=O(r,u),x=j(r),_=q(u);e.fillStyle=n(w),e.fillRect(x-t/2,_-t/2,t,t)}}else if(G.length===0){const t=U/80;for(let i=0;i<80;i++)for(let s=0;s<80;s++){const r=5e3+(5*A-5e3)*i/80,u=3+17*s/80,w=j(r),x=q(u);e.fillStyle=n(0),e.fillRect(w-t/2,x-t/2,t,t)}}else{const a=U/Math.sqrt(G.length);G.forEach(t=>{const i=j(t.angle),s=q(t.velocity);e.fillStyle=n(t.predicted),e.fillRect(i-a/2,s-a/2,a,a)})}Ke(e,n),e.strokeStyle=d.primary,e.lineWidth=2,e.beginPath(),e.moveTo(l,y-l),e.lineTo(b-l,y-l),e.moveTo(l,l),e.lineTo(l,y-l),e.stroke(),e.fillStyle=d.text,e.font="12px Arial, sans-serif",e.textAlign="center",e.fillText("5000",l,y-l+15),e.fillText(String(5*A),b-l,y-l+15),e.fillText("Impact parameter (km)",b/2,y-l+20),e.textAlign="right",e.fillText("3",l-10,y-l),e.fillText("20",l-10,l),e.save(),e.translate(l-15,y/2-25),e.rotate(-Math.PI/2),e.fillText("Velocity (km/s)",0,0),e.restore(),o(k).forEach(a=>{const t=j(a.angle),i=q(a.velocity),s=10,r=e.createRadialGradient(t,i,2,t,i,s);r.addColorStop(0,d.highlight),r.addColorStop(1,"rgba(106, 137, 204, 0)"),e.fillStyle=r,e.beginPath(),e.arc(t,i,s,0,2*Math.PI),e.fill(),e.fillStyle=d.accent,e.beginPath(),e.arc(t,i,6,0,2*Math.PI),e.fill(),e.strokeStyle=d.primary,e.lineWidth=1,e.stroke()})}function Ke(e,n){const t=y-2*l,i=b-l+20,s=l,r=100,u=t/r;for(let m=0;m<r;m++){const S=M+(I-M)*(r-m-1)/r;e.fillStyle=n(S),e.fillRect(i,s+m*u,20,u+1)}e.strokeStyle=d.text,e.lineWidth=1,e.strokeRect(i,s,20,t),e.fillStyle=d.text,e.font="14px Arial, sans-serif",e.textAlign="left";const w=5,x=s+t;e.beginPath(),e.moveTo(i,x),e.lineTo(i+20,x),e.stroke(),e.fillText(M.toFixed(1),i+20+w,x+5);const _=s;e.beginPath(),e.moveTo(i,_),e.lineTo(i+20,_),e.stroke(),e.fillText(I.toFixed(1),i+20+w,_+5);const c=s+t/2;e.beginPath(),e.moveTo(i,c),e.stroke(),e.save(),e.translate(i-25,s+t/2),e.rotate(Math.PI/2),e.textAlign="center",e.fillText("Flyby Distance (km)",0,-60),e.restore()}function ee(){if(!o(Y))return;const e=o(Y).getContext("2d");e.clearRect(0,0,b,y);const t=he().domain([5e3,5*A]).range([y-l-30,l])(o(C)),i=l*2;e.save(),e.setLineDash([5,5]),e.beginPath(),e.moveTo(0,t),e.lineTo(b,t),e.strokeStyle=d.error,e.lineWidth=1,e.stroke(),e.restore();const s=20,r=12,u=2*Math.PI/r;e.beginPath();for(let Z=0;Z<r;Z++){const Ae=Z*u,at=.8+Math.random()*.4,Me=s*at,ze=i+Me*Math.cos(Ae),Ee=t+Me*Math.sin(Ae);Z===0?e.moveTo(ze,Ee):e.lineTo(ze,Ee)}e.closePath(),e.fillStyle=d.surface,e.fill(),e.strokeStyle=d.primary,e.lineWidth=2,e.stroke(),e.fillStyle=d.text,e.font="12px Arial",e.textAlign="center",e.fillText("Asteroid",i,t+s+15);const x=o(R)*10;e.beginPath(),e.moveTo(i,t),e.lineTo(i+x,t),e.strokeStyle=d.error,e.lineWidth=3,e.stroke();const _=8;e.beginPath(),e.moveTo(i+x,t),e.lineTo(i+x-_,t-_/2),e.lineTo(i+x-_,t+_/2),e.closePath(),e.fillStyle=d.error,e.fill();const c=i+x/2,m=t;e.fillStyle=d.text,e.font="12px Arial",e.textAlign="center",e.fillText("velocity",c+25,m-10);const S=20,T=b-l-S,f=y-l-S,H=e.createRadialGradient(T,f,S*.3,T,f,S);H.addColorStop(0,"#66ccff"),H.addColorStop(1,"#003366"),e.beginPath(),e.arc(T,f,S,0,2*Math.PI),e.fillStyle=H,e.fill(),e.strokeStyle="#002244",e.lineWidth=2,e.stroke(),e.beginPath(),e.moveTo(0,f),e.lineTo(b,f),e.strokeStyle=d.primary,e.lineWidth=2,e.stroke();const z=(i+T)/2;e.beginPath(),e.moveTo(z,t),e.lineTo(z,f),e.strokeStyle=d.text,e.lineWidth=1,e.stroke();const F=5;e.beginPath(),e.moveTo(z,t),e.lineTo(z-F,t+F),e.lineTo(z+F,t+F),e.closePath(),e.fillStyle=d.text,e.fill(),e.beginPath(),e.moveTo(z,f),e.lineTo(z-F,f-F),e.lineTo(z+F,f-F),e.closePath(),e.fillStyle=d.text,e.fill(),e.save(),e.fillStyle=d.text,e.font="12px Arial",e.textAlign="left",e.fillText("impact parameter",z+5,(t+f)/2),e.restore(),e.fillStyle=d.text,e.font="12px Arial",e.textAlign="center",e.fillText("Earth",T,f+S+15),e.fillStyle=d.text,e.font="14px Arial",e.textAlign="left",e.fillText(`Impact Parameter: ${o(C).toFixed(0)} km`,20,30),e.fillText(`Velocity: ${o(R).toFixed(2)} km/s`,20,50)}function Ne(){h(N,!o(N)),B()}ht(()=>{console.log("Astroid canvas:",o(Y)),console.log("Contour canvas:",o(W)),Xe(),ee(),B()}),Ce(()=>{},()=>{h(E,0)}),Ce(()=>(o(Y),o(C),o(R)),()=>{o(Y)&&(o(C)!==void 0||o(R)!==void 0)&&ee()}),rt(),ft();var te=bt(),oe=v(te),Ze=g(v(oe),2);p(oe);var ie=g(oe,2),se=v(ie),Je=v(se);p(se);var me=g(se,2),ue=v(me),Qe=g(ue,2);p(me),p(ie);var le=g(ie,2),ae=v(le),ye=g(v(ae)),Ue=v(ye);p(ye),p(ae);var xe=g(ae,2),be=v(xe),et=g(be,2);p(xe),p(le);var Se=g(le,2);{var tt=e=>{var n=yt(),a=v(n),t=g(v(a),4),i=v(t);p(t);var s=g(t,2);p(a),p(n),Re(r=>L(i,`Final score: ${r??""}%`),[()=>(o(E)*100).toFixed(0)],We),K("click",s,qe),fe(e,n)};Ve(Se,e=>{o(Q)&&e(tt)})}var we=g(Se,2),ne=v(we),re=g(v(ne),2);$(re,"width",b),$(re,"height",y),Ie(re,e=>h(Y,e),()=>o(Y)),p(ne);var _e=g(ne,2),ce=g(v(_e),2),D=v(ce);$(D,"width",b+60),$(D,"height",y),Ie(D,e=>h(W,e),()=>o(W)),p(ce);var Te=g(ce,2),de=v(Te),ot=v(de);p(de);var ve=g(de,2),it=v(ve);p(ve);var ke=g(ve,4),Pe=v(ke);{var st=e=>{var n=xt();K("click",n,Oe),fe(e,n)};Ve(Pe,e=>{o(k).length>0&&e(st)})}var pe=g(Pe,2),lt=v(pe,!0);p(pe),p(ke),dt(2),p(Te),p(_e),p(we),p(te),Re((e,n,a)=>{L(Je,`Lives ${o(V)??""}/20`),$(ue,"style",`width: ${e??""}%`),$(Qe,"style",`left: ${e??""}%`),L(Ue,`${n??""}%`),$(be,"style",`width: ${o(E)*100}%`),$(et,"style",`left: ${o(E)*100}%`),vt(D,1,pt(o(X)?"loading":""),"svelte-1wpxoc7"),L(ot,`Samples: ${o(k).length??""}`),L(it,`Current flyby distance: ${a??""}`),L(lt,o(N)?"Show Emulator Prediction":"Show Simulator Function")},[()=>Math.max(0,o(V)/20*100),()=>(o(E)*100).toFixed(0),()=>O(o(C),o(R)).toFixed(2)],We),K("click",Ze,He),K("click",D,je),K("click",pe,Ne),fe(Ge,te),ct()}export{Rt as component};
