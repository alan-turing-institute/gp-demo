import{t as Te,a as me}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as Fe,aa as Ye,ab as Xe,a9 as $e,a5 as He,s as S,a6 as y,i as Le,e as a,ac as I,a1 as b,a7 as m,a8 as Oe}from"../chunks/BJ4irGt7.js";import{e as ie,s as j}from"../chunks/CvaqDwXv.js";import{i as qe}from"../chunks/lIaEYNz1.js";import{s as B}from"../chunks/B9r3SdpA.js";import{l as le,s as je,c as Be}from"../chunks/dhIx7U5O.js";import{b as ue}from"../chunks/CUY-1DrG.js";import{i as De}from"../chunks/CkfO92w8.js";import{o as Ke}from"../chunks/Cpzjerpz.js";import{r as D,s as Ne,v as Se,z as be,l as Ze,m as Je}from"../chunks/PBAI84v4.js";var Qe=Te('<button class="svelte-1p6hea8">Clear Samples</button>'),Ue=Te('<main class="svelte-1p6hea8"><h1 class="svelte-1p6hea8">Astroid with Velocity Vector Explorer</h1> <div class="container svelte-1p6hea8"><div class="panel svelte-1p6hea8"><h2 class="svelte-1p6hea8">Astroid Visualization</h2> <canvas class="svelte-1p6hea8"></canvas></div> <div class="panel svelte-1p6hea8"><h2 class="svelte-1p6hea8">Flyby distance past Earth</h2> <div class="contour-container svelte-1p6hea8"><canvas></canvas></div> <div class="info svelte-1p6hea8"><p class="svelte-1p6hea8"> </p> <p class="svelte-1p6hea8"> </p> <div class="instruction svelte-1p6hea8"><p class="highlight svelte-1p6hea8">Click on the plot above to add sample points and update the GP model</p></div> <div class="button-group svelte-1p6hea8"><!> <button class="info-button svelte-1p6hea8"> </button></div> <div class="energy-function svelte-1p6hea8"><h3 class="svelte-1p6hea8">About the Visualization:</h3> <p class="svelte-1p6hea8"> </p> <p class="svelte-1p6hea8">The energy function (flyby distance) represents the closest approach distance given an objectâ€™s hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p> <p class="svelte-1p6hea8">Click directly on the plot to add sample points and build a GP model that learns this landscape.</p></div></div></div></div></main>');function ht(xe,Pe){Fe(Pe,!1);const r={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let k=I(5e3),A=I(3),T=I([]),G=[],V=I(),M=I(),F=I(!1),Y=I(!1);const w=6371;function _e(e,d,s=398600.4418,t=6371){const o=Math.sqrt(1+Math.pow(d,2)*Math.pow(e,4)/Math.pow(s,2)),n=s*(o-1)/Math.pow(e,2);return n>=t?n:0}function $(e,d){return _e(d,e)}const v=400,p=400,i=40,ne=v-2*i,H=le().domain([5e3,5*w]).range([i,v-i]),L=le().domain([3,20]).range([p-i,i]);let x=1/0,z=-1/0;function ke(){const d=D(5e3,5*w,(5*w-5e3)/50).toArray(),s=D(3,20,17/50).toArray();for(const t of d)for(const o of s){const n=$(t,o);x=Math.min(x,n),z=Math.max(z,n)}x=Math.floor(x*10)/10,z=Math.ceil(z*10)/10,console.log(`Energy range: ${x} to ${z}`)}function Ae(){b(T,[]),G=[],O()}function Me(e){if(a(F))return;const d=a(M).getBoundingClientRect(),s=e.clientX-d.left,t=e.clientY-d.top;if(s>=i&&s<=v-i&&t>=i&&t<=p-i){const o=H.invert(s),n=L.invert(t);b(k,o),b(A,n);const h=$(a(k),a(A));b(T,[...a(T),{angle:a(k),velocity:a(A),energy:h}]),we(),K()}}function we(){if(b(F,!0),a(T).length===0){b(F,!1);return}setTimeout(()=>{const e=a(T).map(l=>[l.angle,l.velocity]),d=a(T).map(l=>l.energy),s=(l,c)=>{const C=(l[0]-c[0])/1e4,g=(l[1]-c[1])/5;return Math.exp(-.5*(C*C+g*g))},t=e.length,o=be(t,t);for(let l=0;l<t;l++)for(let c=0;c<t;c++)o.set([l,c],s(e[l],e[c]));const n=.01;for(let l=0;l<t;l++)o.set([l,l],o.get([l,l])+n);const h=40,P=D(5e3,5*w,(5*w-5e3)/h).toArray(),E=D(3,20,17/h).toArray();G=[];for(const l of P)for(const c of E){const C=[l,c],g=be(1,t);for(let f=0;f<t;f++)g.set([0,f],s(C,e[f]));try{const f=Ze(o,d),R=Je(g,f).get([0,0]);G.push({angle:l,velocity:c,predicted:R})}catch(f){console.error("Error in GP calculation:",f)}}O(),b(F,!1)},50)}function O(){if(!a(M))return;const e=a(M).getContext("2d");e.clearRect(0,0,a(M).width,a(M).height);const d=Ne(Se).domain([z,x]).interpolator(Se);if(a(Y)||G.length===0){const t=ne/80;for(let o=0;o<80;o++)for(let n=0;n<80;n++){const h=5e3+(5*w-5e3)*o/80,P=3+17*n/80,E=$(h,P),l=H(h),c=L(P);e.fillStyle=d(E),e.fillRect(l-t/2,c-t/2,t,t)}}else{const s=ne/Math.sqrt(G.length);G.forEach(t=>{const o=H(t.angle),n=L(t.velocity);e.fillStyle=d(t.predicted),e.fillRect(o-s/2,n-s/2,s,s)})}ze(e,d),e.strokeStyle=r.primary,e.lineWidth=2,e.beginPath(),e.moveTo(i,p-i),e.lineTo(v-i,p-i),e.moveTo(i,i),e.lineTo(i,p-i),e.stroke(),e.fillStyle=r.text,e.font="12px Arial, sans-serif",e.textAlign="center",e.fillText("5000",i,p-i+15),e.fillText(String(5*w),v-i,p-i+15),e.fillText("Impact parameter (km)",v/2,p-i+20),e.textAlign="right",e.fillText("3",i-10,p-i),e.fillText("20",i-10,i),e.save(),e.translate(i-15,p/2-25),e.rotate(-Math.PI/2),e.fillText("Velocity (km/s)",0,0),e.restore(),a(T).forEach(s=>{const t=H(s.angle),o=L(s.velocity),n=10,h=e.createRadialGradient(t,o,2,t,o,n);h.addColorStop(0,r.highlight),h.addColorStop(1,"rgba(106, 137, 204, 0)"),e.fillStyle=h,e.beginPath(),e.arc(t,o,n,0,2*Math.PI),e.fill(),e.fillStyle=r.accent,e.beginPath(),e.arc(t,o,6,0,2*Math.PI),e.fill(),e.strokeStyle=r.primary,e.lineWidth=1,e.stroke()})}function ze(e,d){const t=p-2*i,o=v-i+20,n=i,h=100,P=t/h;for(let g=0;g<h;g++){const f=x+(z-x)*(h-g-1)/h;e.fillStyle=d(f),e.fillRect(o,n+g*P,20,P+1)}e.strokeStyle=r.text,e.lineWidth=1,e.strokeRect(o,n,20,t),e.fillStyle=r.text,e.font="14px Arial, sans-serif",e.textAlign="left";const E=5,l=n+t;e.beginPath(),e.moveTo(o,l),e.lineTo(o+20,l),e.stroke(),e.fillText(x.toFixed(1),o+20+E,l+5);const c=n;e.beginPath(),e.moveTo(o,c),e.lineTo(o+20,c),e.stroke(),e.fillText(z.toFixed(1),o+20+E,c+5);const C=n+t/2;e.beginPath(),e.moveTo(o,C),e.stroke(),e.save(),e.translate(o-25,n+t/2),e.rotate(Math.PI/2),e.textAlign="center",e.fillText("Flyby Distance (km)",0,-60),e.restore()}function K(){if(!a(V))return;const e=a(V).getContext("2d");e.clearRect(0,0,v,p);const t=le().domain([5e3,5*w]).range([p-i-30,i])(a(k)),o=i*2;e.save(),e.setLineDash([5,5]),e.beginPath(),e.moveTo(0,t),e.lineTo(v,t),e.strokeStyle=r.error,e.lineWidth=1,e.stroke(),e.restore();const n=20,h=12,P=2*Math.PI/h;e.beginPath();for(let q=0;q<h;q++){const pe=q*P,Ge=.8+Math.random()*.4,ve=n*Ge,ge=o+ve*Math.cos(pe),ye=t+ve*Math.sin(pe);q===0?e.moveTo(ge,ye):e.lineTo(ge,ye)}e.closePath(),e.fillStyle=r.surface,e.fill(),e.strokeStyle=r.primary,e.lineWidth=2,e.stroke(),e.fillStyle=r.text,e.font="12px Arial",e.textAlign="center",e.fillText("Asteroid",o,t+n+15);const l=a(A)*10;e.beginPath(),e.moveTo(o,t),e.lineTo(o+l,t),e.strokeStyle=r.error,e.lineWidth=3,e.stroke();const c=8;e.beginPath(),e.moveTo(o+l,t),e.lineTo(o+l-c,t-c/2),e.lineTo(o+l-c,t+c/2),e.closePath(),e.fillStyle=r.error,e.fill();const C=o+l/2,g=t;e.fillStyle=r.text,e.font="12px Arial",e.textAlign="center",e.fillText("velocity",C+25,g-10);const f=20,R=v-i-f,u=p-i-f,ae=e.createRadialGradient(R,u,f*.3,R,u,f);ae.addColorStop(0,"#66ccff"),ae.addColorStop(1,"#003366"),e.beginPath(),e.arc(R,u,f,0,2*Math.PI),e.fillStyle=ae,e.fill(),e.strokeStyle="#002244",e.lineWidth=2,e.stroke(),e.beginPath(),e.moveTo(0,u),e.lineTo(v,u),e.strokeStyle=r.primary,e.lineWidth=2,e.stroke();const _=(o+R)/2;e.beginPath(),e.moveTo(_,t),e.lineTo(_,u),e.strokeStyle=r.text,e.lineWidth=1,e.stroke();const W=5;e.beginPath(),e.moveTo(_,t),e.lineTo(_-W,t+W),e.lineTo(_+W,t+W),e.closePath(),e.fillStyle=r.text,e.fill(),e.beginPath(),e.moveTo(_,u),e.lineTo(_-W,u-W),e.lineTo(_+W,u-W),e.closePath(),e.fillStyle=r.text,e.fill(),e.save(),e.fillStyle=r.text,e.font="12px Arial",e.textAlign="left",e.fillText("impact parameter",_+5,(t+u)/2),e.restore(),e.fillStyle=r.text,e.font="12px Arial",e.textAlign="center",e.fillText("Earth",R,u+f+15),e.fillStyle=r.text,e.font="14px Arial",e.textAlign="left",e.fillText(`Impact Parameter: ${a(k).toFixed(0)} km`,20,30),e.fillText(`Velocity: ${a(A).toFixed(2)} km/s`,20,50)}function Ce(){b(Y,!a(Y)),O()}Ke(()=>{console.log("Astroid canvas:",a(V)),console.log("Contour canvas:",a(M)),ke(),K(),O()}),Ye(()=>(a(V),a(k),a(A)),()=>{a(V)&&(a(k)!==void 0||a(A)!==void 0)&&K()}),Xe(),De();var N=Ue(),se=S(y(N),2),Z=y(se),J=S(y(Z),2);B(J,"width",v),B(J,"height",p),ue(J,e=>b(V,e),()=>a(V)),m(Z);var re=S(Z,2),Q=S(y(re),2),X=y(Q);B(X,"width",v+60),B(X,"height",p),ue(X,e=>b(M,e),()=>a(M)),m(Q);var ce=S(Q,2),U=y(ce),We=y(U);m(U);var ee=S(U,2),Ve=y(ee);m(ee);var te=S(ee,4),de=y(te);{var Ee=e=>{var d=Qe();ie("click",d,Ae),me(e,d)};qe(de,e=>{a(T).length>0&&e(Ee)})}var oe=S(de,2),Re=y(oe,!0);m(oe),m(te);var he=S(te,2),fe=S(y(he),2),Ie=y(fe,!0);m(fe),Oe(4),m(he),m(ce),m(re),m(se),m(N),$e(e=>{je(X,1,Be(a(F)?"loading":""),"svelte-1p6hea8"),j(We,`Samples: ${a(T).length??""}`),j(Ve,`Current energy: ${e??""}`),j(Re,a(Y)?"Show GP Prediction":"Show Energy Function"),j(Ie,a(Y)?"Showing actual energy function":"Showing Gaussian Process prediction")},[()=>$(a(k),a(A)).toFixed(2)],Le),ie("click",X,Me),ie("click",oe,Ce),me(xe,N),He()}export{ht as component};
