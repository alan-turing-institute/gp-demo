import{t as ft,a as nt}from"../chunks/XXpPz1rO.js";import"../chunks/CG3dSJ55.js";import{am as kt,as as At,at as zt,ar as Ct,an as Et,s as u,ao as g,i as Vt,e as i,au as A,Q as m,ap as p,aq as It}from"../chunks/C9kX8gL9.js";import{e as J,s as H}from"../chunks/CWldEeeP.js";import{i as Wt}from"../chunks/DDIuJh5f.js";import{s as L}from"../chunks/BK-Xurv5.js";import{l as st,s as Rt,c as Ft}from"../chunks/C0MQ2VaA.js";import{b as rt}from"../chunks/CUbg1kqr.js";import{i as Gt}from"../chunks/CmZZvN_p.js";import{o as $t}from"../chunks/DWMzei4F.js";import{r as X,s as qt,v as ct,z as dt,l as Ht,m as Lt}from"../chunks/BoOaU208.js";var Xt=ft('<button class="svelte-i0d8w">Clear Samples</button>'),jt=ft('<main class="svelte-i0d8w"><h1 class="svelte-i0d8w">Astroid with Velocity Vector Explorer</h1> <div class="container svelte-i0d8w"><div class="panel svelte-i0d8w"><h2 class="svelte-i0d8w">Astroid Visualization</h2> <canvas class="svelte-i0d8w"></canvas></div> <div class="panel svelte-i0d8w"><h2 class="svelte-i0d8w">Energy Landscape</h2> <div class="contour-container svelte-i0d8w"><canvas></canvas></div> <div class="info svelte-i0d8w"><p class="svelte-i0d8w"> </p> <p class="svelte-i0d8w"> </p> <div class="instruction svelte-i0d8w"><p class="highlight svelte-i0d8w">Click on the plot above to add sample points and update the GP model</p></div> <div class="button-group svelte-i0d8w"><!> <button class="info-button svelte-i0d8w"> </button></div> <div class="energy-function svelte-i0d8w"><h3 class="svelte-i0d8w">About the Visualization:</h3> <p class="svelte-i0d8w"> </p> <p class="svelte-i0d8w">The energy function (flyby distance) represents the closest approach distance given an objectâ€™s hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p> <p class="svelte-i0d8w">Click directly on the plot to add sample points and build a GP model that learns this landscape.</p></div></div></div></div></main>');function ee(vt,ht){kt(ht,!1);const P={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50"};let _=A(5e3),x=A(3),b=A([]),z=[],k=A(),C=A(),V=A(!1),I=A(!1);const T=6371;function gt(t,r,d=398600.4418,e=6371){const o=Math.sqrt(1+Math.pow(r,2)*Math.pow(t,4)/Math.pow(d,2)),l=d*(o-1)/Math.pow(t,2);return l>=e?l:0}function F(t,r){return gt(r,t)}const h=400,c=400,a=40,U=h-2*a,G=st().domain([5e3,5*T]).range([a,h-a]),$=st().domain([3,20]).range([c-a,a]);let y=1/0,S=-1/0;function pt(){const r=X(5e3,5*T,(5*T-5e3)/50).toArray(),d=X(3,20,17/50).toArray();for(const e of r)for(const o of d){const l=F(e,o);y=Math.min(y,l),S=Math.max(S,l)}y=Math.floor(y*10)/10,S=Math.ceil(S*10)/10,console.log(`Energy range: ${y} to ${S}`)}function yt(){m(b,[]),z=[],q()}function ut(t){if(i(V))return;const r=i(C).getBoundingClientRect(),d=t.clientX-r.left,e=t.clientY-r.top;if(d>=a&&d<=h-a&&e>=a&&e<=c-a){const o=G.invert(d),l=$.invert(e);m(_,o),m(x,l);const s=F(i(_),i(x));m(b,[...i(b),{angle:i(_),velocity:i(x),energy:s}]),mt(),j()}}function mt(){if(m(V,!0),i(b).length===0){m(V,!1);return}setTimeout(()=>{const t=i(b).map(n=>[n.angle,n.velocity]),r=i(b).map(n=>n.energy),d=(n,v)=>{const E=(n[0]-v[0])/1e4,R=(n[1]-v[1])/5;return Math.exp(-.5*(E*E+R*R))},e=t.length,o=dt(e,e);for(let n=0;n<e;n++)for(let v=0;v<e;v++)o.set([n,v],d(t[n],t[v]));const l=.01;for(let n=0;n<e;n++)o.set([n,n],o.get([n,n])+l);const s=40,f=X(5e3,5*T,(5*T-5e3)/s).toArray(),w=X(3,20,17/s).toArray();z=[];for(const n of f)for(const v of w){const E=[n,v],R=dt(1,e);for(let M=0;M<e;M++)R.set([0,M],d(E,t[M]));try{const M=Ht(o,r),Pt=Lt(R,M).get([0,0]);z.push({angle:n,velocity:v,predicted:Pt})}catch(M){console.error("Error in GP calculation:",M)}}q(),m(V,!1)},50)}function q(){if(!i(C))return;const t=i(C).getContext("2d");t.clearRect(0,0,h,c);const r=qt(ct).domain([S,y]).interpolator(ct);if(i(I)||z.length===0){const o=U/80;for(let l=0;l<80;l++)for(let s=0;s<80;s++){const f=5e3+(5*T-5e3)*l/80,w=3+17*s/80,n=F(f,w),v=G(f),E=$(w);t.fillStyle=r(n),t.fillRect(v-o/2,E-o/2,o,o)}}else{const e=U/Math.sqrt(z.length);z.forEach(o=>{const l=G(o.angle),s=$(o.velocity);t.fillStyle=r(o.predicted),t.fillRect(l-e/2,s-e/2,e,e)})}bt(t,r),t.strokeStyle=P.primary,t.lineWidth=2,t.beginPath(),t.moveTo(a,c-a),t.lineTo(h-a,c-a),t.moveTo(a,a),t.lineTo(a,c-a),t.stroke(),t.fillStyle=P.text,t.font="bold 14px Arial, sans-serif",t.textAlign="center";const d=Math.round((5e3+5*T)/2);t.fillText("5000",a,c-a+15),t.fillText(d.toString(),h/2,c-a+15),t.fillText(String(5*T),h-a,c-a+15),t.fillText("impact parameter (km)",h-a+15,c-a+5),t.textAlign="right",t.fillText("3",a-5,c-a),t.fillText("11.5",a-5,c/2),t.fillText("20",a-5,a),t.fillText("Velocity (km/s)",a-15,a-10),i(b).forEach(e=>{const o=G(e.angle),l=$(e.velocity),s=8,f=t.createRadialGradient(o,l,2,o,l,s);f.addColorStop(0,P.highlight),f.addColorStop(1,"rgba(106, 137, 204, 0)"),t.fillStyle=f,t.beginPath(),t.arc(o,l,s,0,2*Math.PI),t.fill(),t.fillStyle=P.accent,t.beginPath(),t.arc(o,l,4,0,2*Math.PI),t.fill(),t.strokeStyle=P.primary,t.lineWidth=1,t.stroke()})}function bt(t,r){const e=c-2*a,o=h-a+20,l=a,s=100,f=e/s;for(let n=0;n<s;n++){const v=y+(S-y)*(s-n-1)/s;t.fillStyle=r(v),t.fillRect(o,l+n*f,20,f+1)}t.strokeStyle=P.text,t.lineWidth=1,t.strokeRect(o,l,20,e),t.fillStyle=P.text,t.font="12px Arial, sans-serif",t.textAlign="left",t.fillText(y.toFixed(1),o+20+5,l+e),t.fillText(S.toFixed(1),o+20+5,l);const w=(y+S)/2;t.fillText(w.toFixed(1),o+20+5,l+e/2),t.save(),t.translate(o+20+25,l+e/2),t.rotate(-Math.PI/2),t.textAlign="center",t.fillText("Distance to Earth",0,0),t.restore()}function j(){if(!i(k))return;const t=i(k).getContext("2d");t.clearRect(0,0,h,c);const r=h/2,d=c/2,e=120;t.save(),t.translate(r,d),t.rotate(i(_)*Math.PI/180),t.beginPath();for(let s=0;s<=2*Math.PI;s+=.01){const f=e*Math.pow(Math.cos(s),3),w=e*Math.pow(Math.sin(s),3);s===0?t.moveTo(f,w):t.lineTo(f,w)}t.closePath(),t.fillStyle="rgba(200,200,200,0.3)",t.fill(),t.strokeStyle="#333",t.lineWidth=2,t.stroke();const o=i(x)*50;t.strokeStyle="#cc0000",t.lineWidth=2,t.beginPath(),t.moveTo(e,0),t.lineTo(e+o,0),t.stroke();const l=8;t.beginPath(),t.moveTo(e+o,0),t.lineTo(e+o-l,-8/2),t.lineTo(e+o-l,l/2),t.closePath(),t.fillStyle="#cc0000",t.fill(),t.fillStyle="#0066cc",t.beginPath(),t.arc(0,0,5,0,2*Math.PI),t.fill(),t.fillStyle="#00cc00",t.beginPath(),t.arc(e,0,5,0,2*Math.PI),t.fill(),t.restore(),t.fillStyle="#000",t.font="14px Arial",t.textAlign="left",t.fillText(`impact parameter: ${i(_).toFixed(0)} km`,20,30),t.fillText(`Velocity: ${i(x).toFixed(2)} km/s`,20,50)}function St(){m(I,!i(I)),q()}$t(()=>{console.log("Astroid canvas:",i(k)),console.log("Contour canvas:",i(C)),pt(),j(),q()}),At(()=>(i(k),i(_),i(x)),()=>{i(k)&&(i(_)!==void 0||i(x)!==void 0)&&j()}),zt(),Gt();var B=jt(),tt=u(g(B),2),O=g(tt),Y=u(g(O),2);L(Y,"width",h),L(Y,"height",c),rt(Y,t=>m(k,t),()=>i(k)),p(O);var et=u(O,2),D=u(g(et),2),W=g(D);L(W,"width",h+60),L(W,"height",c),rt(W,t=>m(C,t),()=>i(C)),p(D);var it=u(D,2),K=g(it),wt=g(K);p(K);var N=u(K,2),_t=g(N);p(N);var Q=u(N,4),ot=g(Q);{var xt=t=>{var r=Xt();J("click",r,yt),nt(t,r)};Wt(ot,t=>{i(b).length>0&&t(xt)})}var Z=u(ot,2),Tt=g(Z,!0);p(Z),p(Q);var at=u(Q,2),lt=u(g(at),2),Mt=g(lt,!0);p(lt),It(4),p(at),p(it),p(et),p(tt),p(B),Ct(t=>{Rt(W,1,Ft(i(V)?"loading":""),"svelte-i0d8w"),H(wt,`Samples: ${i(b).length??""}`),H(_t,`Current energy: ${t??""}`),H(Tt,i(I)?"Show GP Prediction":"Show Energy Function"),H(Mt,i(I)?"Showing actual energy function":"Showing Gaussian Process prediction")},[()=>F(i(_),i(x)).toFixed(2)],Vt),J("click",W,ut),J("click",Z,St),nt(vt,B),Et()}export{ee as component};
