import{t as q,a as j}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as ae,aa as Ct,ab as le,a9 as tt,a5 as ie,s as p,a6 as h,i as Wt,e as l,ac as A,a1 as u,a7 as f,f as Rt,a8 as se}from"../chunks/BJ4irGt7.js";import{e as G,s as N}from"../chunks/CvaqDwXv.js";import{i as et}from"../chunks/lIaEYNz1.js";import{s as P}from"../chunks/B9r3SdpA.js";import{l as ft,s as gt,c as Vt}from"../chunks/dhIx7U5O.js";import{b as at}from"../chunks/CUY-1DrG.js";import{i as oe}from"../chunks/CkfO92w8.js";import{o as Ft}from"../chunks/Cpzjerpz.js";import{r as lt,s as ne,v as It,z as Gt,l as re,m as ce}from"../chunks/PBAI84v4.js";var ve=q(`<div class="game-ended-popup svelte-18w6la0"><div class="popup-content svelte-18w6la0"><h2 class="svelte-18w6la0">Game Ended</h2> <p class="svelte-18w6la0">You've used all your lives!</p> <p class="svelte-18w6la0"> </p> <button class="svelte-18w6la0">Play Again</button></div></div>`),de=q('<button class="svelte-18w6la0">Clear Samples</button>'),he=q('<div class="panel svelte-18w6la0"><h2 class="svelte-18w6la0">Asteroid Visualization</h2> <canvas class="svelte-18w6la0"></canvas></div> <div class="panel svelte-18w6la0"><h2 class="svelte-18w6la0">Flyby distance past Earth</h2> <div class="contour-container svelte-18w6la0"><canvas></canvas></div> <div class="button-group svelte-18w6la0"><!> <button class="info-button svelte-18w6la0"> </button></div> <div class="instruction svelte-18w6la0"><p class="svelte-18w6la0">Click directly on the plot above to sample points. This will run the simulation and update the emulator model based on the simulator output.</p></div></div>',1),fe=q('<button class="svelte-18w6la0">Clear Samples</button>'),ge=q('<div class="grid-item energy-plot svelte-18w6la0"><h2 class="svelte-18w6la0">Flyby distance past Earth</h2> <div class="contour-container svelte-18w6la0"><canvas></canvas></div></div> <div class="grid-item buttons svelte-18w6la0"><div class="instruction svelte-18w6la0"><p class="svelte-18w6la0">Click directly on the plot to sample points. This will run the simulation and update the emulator model based on the simulator output.</p></div> <div class="vertical-button-group svelte-18w6la0"><!> <button class="info-button svelte-18w6la0"> </button></div></div> <div class="grid-item molecule-panel svelte-18w6la0"><h2 class="svelte-18w6la0">Asteroid Visualization</h2> <canvas class="svelte-18w6la0"></canvas></div>',1),pe=q('<main class="svelte-18w6la0"><h1 class="svelte-18w6la0">Asteroid Explorer</h1> <div class="instruction svelte-18w6la0"><p class="svelte-18w6la0">Flyby distance is the closest approach distance given an object‚Äôs hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p></div> <div class="instruction svelte-18w6la0"><p class="highlight svelte-18w6la0">Your goal is to train an emulator that accurately predicts flyby distance using as few asteroid simulator runs as possible.</p></div> <div class="bars-container svelte-18w6la0"><div class="live-bar-container svelte-18w6la0"><div class="lives-label"> </div> <div class="live-bar svelte-18w6la0"><div class="lives-remaining svelte-18w6la0"></div> <span class="heart svelte-18w6la0">üí∑</span></div></div> <div></div> <div class="score-bar-container svelte-18w6la0"><div class="score-label">Score: <span id="score-percentage"> </span></div> <div class="score-bar svelte-18w6la0"><div class="score-value svelte-18w6la0" id="score-bar"></div> <span class="star svelte-18w6la0" id="score-star">‚≠ê</span></div></div></div> <!> <div><!></div> <div class="button-group svelte-18w6la0" style="margin-top: 20px; text-align: center;"><button class="info-button svelte-18w6la0"><span>Go back</span></button></div></main>');function Ae(Yt,$t){ae($t,!1);const R=A();function Ht(){window.location.href="https://alan-turing-institute.github.io/gp-demo/"}const m={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let Y=A(5e3),$=A(3),M=A([]),H=[],z=A(),k=A(),L=A(!1),B=A(!1),V=A(20),it=A(!1);const E=6371;let st=A(!1);function ot(){u(st,window.innerHeight>window.innerWidth)}Ft(()=>(pt(),J(),setTimeout(()=>{X()},100),ot(),window.addEventListener("resize",ot),()=>{window.removeEventListener("resize",ot)}));function Lt(t,o,n=398600.4418,e=6371){const a=Math.sqrt(1+Math.pow(o,2)*Math.pow(t,4)/Math.pow(n,2)),i=n*(a-1)/Math.pow(t,2);return i>=e?i:0}function Z(t,o){return Lt(o,t)}const x=400,S=400,r=40,nt=x-2*r,D=ft().domain([5e3,5*E]).range([r,x-r]),K=ft().domain([3,20]).range([S-r,r]);let C=1/0,F=-1/0;function pt(){const o=lt(5e3,5*E,(5*E-5e3)/50).toArray(),n=lt(3,20,17/50).toArray();for(const e of o)for(const a of n){const i=Z(e,a);C=Math.min(C,i),F=Math.max(F,i)}C=Math.floor(C*10)/10,F=Math.ceil(F*10)/10,console.log(`Energy range: ${C} to ${F}`)}function ut(){u(M,[]),H=[],X(),u(V,20),u(R,0)}function mt(t){if(l(L)||l(V)<=0)return;const o=l(k).getBoundingClientRect(),n=l(k).width/o.width,e=l(k).height/o.height,a=(t.clientX-o.left)*n,i=(t.clientY-o.top)*e;if(a>=r&&a<=x-r&&i>=r&&i<=S-r){const s=D.invert(a),d=K.invert(i);u(Y,s),u($,d);const b=Z(l(Y),l($));u(M,[...l(M),{angle:l(Y),velocity:l($),energy:b}]),u(V,l(V)-1),l(V)===0&&u(it,!0),jt(),J()}}function Xt(){u(V,20),u(R,0),u(M,[]),H=[],u(it,!1),X()}function Ot(t,o){if(t.length!==o.length||t.length===0)throw new Error("Arrays must be of the same length and non-empty");const n=t.reduce((s,d)=>s+d,0)/t.length,e=t.reduce((s,d)=>s+Math.pow(d-n,2),0),i=1-t.reduce((s,d,b)=>s+Math.pow(d-o[b],2),0)/e;return Math.max(0,i)}function jt(){u(L,!0);let t=[],o=[];if(l(M).length===0){u(L,!1);return}setTimeout(()=>{const n=l(M).map(c=>[c.angle,c.velocity]),e=l(M).map(c=>c.energy),a=(c,v)=>{const g=(c[0]-v[0])/1e4,T=(c[1]-v[1])/5;return Math.exp(-.5*(g*g+T*T))},i=n.length,s=Gt(i,i);for(let c=0;c<i;c++)for(let v=0;v<i;v++)s.set([c,v],a(n[c],n[v]));const d=.01;for(let c=0;c<i;c++)s.set([c,c],s.get([c,c])+d);const b=40,y=lt(5e3,5*E,(5*E-5e3)/b).toArray(),_=lt(3,20,17/b).toArray();H=[];for(const c of y)for(const v of _){const g=[c,v],T=Gt(1,i);for(let w=0;w<i;w++)T.set([0,w],a(g,n[w]));try{const w=re(s,e),O=ce(T,w).get([0,0]);H.push({angle:c,velocity:v,predicted:O}),o.push(O),t.push(Z(c,v))}catch(w){console.error("Error in GP calculation:",w)}}X(),u(R,Ot(t,o)),u(L,!1)},50)}function X(){if(!l(k))return;const t=l(k).getContext("2d");t.clearRect(0,0,l(k).width,l(k).height);const o=ne(It).domain([F,C]).interpolator(It);if(l(B)){const e=nt/80;for(let a=0;a<80;a++)for(let i=0;i<80;i++){const s=5e3+(5*E-5e3)*a/80,d=3+17*i/80,b=Z(s,d),y=D(s),_=K(d);t.fillStyle=o(b),t.fillRect(y-e/2,_-e/2,e,e)}}else if(H.length===0){const e=nt/80;for(let a=0;a<80;a++)for(let i=0;i<80;i++){const s=5e3+(5*E-5e3)*a/80,d=3+17*i/80,b=D(s),y=K(d);t.fillStyle=o(0),t.fillRect(b-e/2,y-e/2,e,e)}}else{const n=nt/Math.sqrt(H.length);H.forEach(e=>{const a=D(e.angle),i=K(e.velocity);t.fillStyle=o(e.predicted),t.fillRect(a-n/2,i-n/2,n,n)})}qt(t,o),t.strokeStyle=m.primary,t.lineWidth=2,t.beginPath(),t.moveTo(r,S-r),t.lineTo(x-r,S-r),t.moveTo(r,r),t.lineTo(r,S-r),t.stroke(),t.fillStyle=m.text,t.font="12px Arial, sans-serif",t.textAlign="center",t.fillText("5000",r,S-r+15),t.fillText(String(5*E),x-r,S-r+15),t.fillText("Impact parameter (km)",x/2,S-r+20),t.textAlign="right",t.fillText("3",r-10,S-r),t.fillText("20",r-10,r),t.save(),t.translate(r-15,S/2-25),t.rotate(-Math.PI/2),t.fillText("Velocity (km/s)",0,0),t.restore(),l(M).forEach(n=>{const e=D(n.angle),a=K(n.velocity),i=10,s=t.createRadialGradient(e,a,2,e,a,i);s.addColorStop(0,m.highlight),s.addColorStop(1,"rgba(106, 137, 204, 0)"),t.fillStyle=s,t.beginPath(),t.arc(e,a,i,0,2*Math.PI),t.fill(),t.fillStyle=m.accent,t.beginPath(),t.arc(e,a,6,0,2*Math.PI),t.fill(),t.strokeStyle=m.primary,t.lineWidth=1,t.stroke()})}function qt(t,o){const e=S-2*r,a=x-r+20,i=r,s=100,d=e/s;for(let v=0;v<s;v++){const g=C+(F-C)*(s-v-1)/s;t.fillStyle=o(g),t.fillRect(a,i+v*d,20,d+1)}t.strokeStyle=m.text,t.lineWidth=1,t.strokeRect(a,i,20,e),t.fillStyle=m.text,t.font="14px Arial, sans-serif",t.textAlign="left";const b=5,y=i+e;t.beginPath(),t.moveTo(a,y),t.lineTo(a+20,y),t.stroke(),t.fillText(C.toFixed(1),a+20+b,y+5);const _=i;t.beginPath(),t.moveTo(a,_),t.lineTo(a+20,_),t.stroke(),t.fillText(F.toFixed(1),a+20+b,_+5);const c=i+e/2;t.beginPath(),t.moveTo(a,c),t.stroke(),t.save(),t.translate(a-25,i+e/2),t.rotate(Math.PI/2),t.textAlign="center",t.fillText("Flyby Distance (km)",0,-60),t.restore()}function J(){if(!l(z))return;const t=l(z).getContext("2d");t.clearRect(0,0,x,S);const e=ft().domain([5e3,5*E]).range([S-r-30,r])(l(Y)),a=r*2;t.save(),t.setLineDash([5,5]),t.beginPath(),t.moveTo(0,e),t.lineTo(x,e),t.strokeStyle=m.error,t.lineWidth=1,t.stroke(),t.restore();const i=20,s=12,d=2*Math.PI/s;t.beginPath();for(let U=0;U<s;U++){const At=U*d,ee=.8+Math.random()*.4,Mt=i*ee,zt=a+Mt*Math.cos(At),Et=e+Mt*Math.sin(At);U===0?t.moveTo(zt,Et):t.lineTo(zt,Et)}t.closePath(),t.fillStyle=m.surface,t.fill(),t.strokeStyle=m.primary,t.lineWidth=2,t.stroke(),t.fillStyle=m.text,t.font="12px Arial",t.textAlign="center",t.fillText("Asteroid",a,e+i+15);const y=l($)*10;t.beginPath(),t.moveTo(a,e),t.lineTo(a+y,e),t.strokeStyle=m.error,t.lineWidth=3,t.stroke();const _=8;t.beginPath(),t.moveTo(a+y,e),t.lineTo(a+y-_,e-_/2),t.lineTo(a+y-_,e+_/2),t.closePath(),t.fillStyle=m.error,t.fill();const c=a+y/2,v=e;t.fillStyle=m.text,t.font="12px Arial",t.textAlign="center",t.fillText("velocity",c+25,v-10);const g=20,T=x-r-g,w=S-r-g,O=t.createRadialGradient(T,w,g*.3,T,w,g);O.addColorStop(0,"#66ccff"),O.addColorStop(1,"#003366"),t.beginPath(),t.arc(T,w,g,0,2*Math.PI),t.fillStyle=O,t.fill(),t.strokeStyle="#002244",t.lineWidth=2,t.stroke(),t.beginPath(),t.moveTo(0,w),t.lineTo(x,w),t.strokeStyle=m.primary,t.lineWidth=2,t.stroke();const W=(a+T)/2;t.beginPath(),t.moveTo(W,e),t.lineTo(W,w),t.strokeStyle=m.text,t.lineWidth=1,t.stroke();const I=5;t.beginPath(),t.moveTo(W,e),t.lineTo(W-I,e+I),t.lineTo(W+I,e+I),t.closePath(),t.fillStyle=m.text,t.fill(),t.beginPath(),t.moveTo(W,w),t.lineTo(W-I,w-I),t.lineTo(W+I,w-I),t.closePath(),t.fillStyle=m.text,t.fill(),t.save(),t.fillStyle=m.text,t.font="12px Arial",t.textAlign="left",t.fillText("impact parameter",W+5,(e+w)/2),t.restore(),t.fillStyle=m.text,t.font="12px Arial",t.textAlign="center",t.fillText("Earth",T,w+g+15),t.fillStyle=m.text,t.font="14px Arial",t.textAlign="left",t.fillText(`Impact Parameter: ${l(Y).toFixed(0)} km`,20,30),t.fillText(`Velocity: ${l($).toFixed(2)} km/s`,20,50)}function yt(){u(B,!l(B)),X()}Ft(()=>{console.log("Astroid canvas:",l(z)),console.log("Contour canvas:",l(k)),pt(),J(),X()}),Ct(()=>{},()=>{u(R,0)}),Ct(()=>(l(z),l(Y),l($)),()=>{l(z)&&(l(Y)!==void 0||l($)!==void 0)&&J()}),le(),oe();var rt=pe(),ct=p(h(rt),6),vt=h(ct),dt=h(vt),Bt=h(dt);f(dt);var wt=p(dt,2),bt=h(wt),Dt=p(bt,2);f(wt),f(vt);var St=p(vt,4),ht=h(St),_t=p(h(ht)),Kt=h(_t);f(_t),f(ht);var xt=p(ht,2),Tt=h(xt),Nt=p(Tt,2);f(xt),f(St),f(ct);var kt=p(ct,2);{var Zt=t=>{var o=ve(),n=h(o),e=p(h(n),4),a=h(e);f(e);var i=p(e,2);f(n),f(o),tt(s=>N(a,`Final score: ${s??""}%`),[()=>(l(R)*100).toFixed(0)],Wt),G("click",i,Xt),j(t,o)};et(kt,t=>{l(it)&&t(Zt)})}var Q=p(kt,2),Jt=h(Q);{var Qt=t=>{var o=he(),n=Rt(o),e=p(h(n),2);P(e,"width",x),P(e,"height",S),at(e,v=>u(z,v),()=>l(z)),f(n);var a=p(n,2),i=p(h(a),2),s=h(i);P(s,"width",x+60),P(s,"height",S),at(s,v=>u(k,v),()=>l(k)),f(i);var d=p(i,2),b=h(d);{var y=v=>{var g=de();G("click",g,ut),j(v,g)};et(b,v=>{l(M).length>0&&v(y)})}var _=p(b,2),c=h(_,!0);f(_),f(d),se(2),f(a),tt(()=>{gt(s,1,Vt(l(L)?"loading":""),"svelte-18w6la0"),N(c,l(B)?"Show Emulator Prediction":"Show Simulator Function")}),G("click",s,mt),G("click",_,yt),j(t,o)},Ut=t=>{var o=ge(),n=Rt(o),e=p(h(n),2),a=h(e);P(a,"width",x+60),P(a,"height",S),at(a,g=>u(k,g),()=>l(k)),f(e),f(n);var i=p(n,2),s=p(h(i),2),d=h(s);{var b=g=>{var T=fe();G("click",T,ut),j(g,T)};et(d,g=>{l(M).length>0&&g(b)})}var y=p(d,2),_=h(y,!0);f(y),f(s),f(i);var c=p(i,2),v=p(h(c),2);P(v,"width",x),P(v,"height",S),at(v,g=>u(z,g),()=>l(z)),f(c),tt(()=>{gt(a,1,Vt(l(L)?"loading":""),"svelte-18w6la0"),N(_,l(B)?"Show Emulator Prediction":"Show Simulator Function")}),G("click",a,mt),G("click",y,yt),j(t,o)};et(Jt,t=>{l(st)?t(Ut,!1):t(Qt)})}f(Q);var Pt=p(Q,2),te=h(Pt);f(Pt),f(rt),tt((t,o)=>{N(Bt,`Guesses left ${l(V)??""}/20`),P(bt,"style",`width: ${t??""}%`),P(Dt,"style",`left: ${t??""}%`),N(Kt,`${o??""}%`),P(Tt,"style",`width: ${l(R)*100}%`),P(Nt,"style",`left: ${l(R)*100}%`),gt(Q,1,`responsive-grid ${(l(st)?"vertical":"horizontal")??""}`,"svelte-18w6la0")},[()=>Math.max(0,l(V)/20*100),()=>(l(R)*100).toFixed(0)],Wt),G("click",te,Ht),j(Yt,rt),ie()}export{Ae as component};
