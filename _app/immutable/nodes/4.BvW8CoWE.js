import{t as B,a as q}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as ie,aa as Ct,ab as se,a9 as et,a5 as oe,s as u,a6 as f,i as Wt,e as a,ac as M,a1 as d,a7 as g,f as Ft,a8 as ne}from"../chunks/BJ4irGt7.js";import{e as Y,s as K}from"../chunks/CvaqDwXv.js";import{i as at}from"../chunks/lIaEYNz1.js";import{s as A}from"../chunks/B9r3SdpA.js";import{l as ft,s as gt,c as Rt}from"../chunks/dhIx7U5O.js";import{b as lt}from"../chunks/CUY-1DrG.js";import{i as re}from"../chunks/CkfO92w8.js";import{o as Vt}from"../chunks/Cpzjerpz.js";import{r as it,s as ce,v as It,z as Gt,l as ve,m as de}from"../chunks/PBAI84v4.js";var he=B(`<div class="game-ended-popup svelte-18w6la0"><div class="popup-content svelte-18w6la0"><h2 class="svelte-18w6la0">Game Ended</h2> <p class="svelte-18w6la0">You've used all your lives!</p> <p class="svelte-18w6la0"> </p> <button class="svelte-18w6la0">Play Again</button></div></div>`),fe=B('<button class="svelte-18w6la0">Clear Samples</button>'),ge=B('<div class="panel svelte-18w6la0"><h2 class="svelte-18w6la0">Asteroid Visualization</h2> <canvas class="svelte-18w6la0"></canvas></div> <div class="panel svelte-18w6la0"><h2 class="svelte-18w6la0">Flyby distance past Earth</h2> <div class="contour-container svelte-18w6la0"><canvas></canvas></div> <div class="button-group svelte-18w6la0"><!> <button class="info-button svelte-18w6la0"> </button></div> <div class="instruction svelte-18w6la0"><p class="svelte-18w6la0">Click directly on the plot above to sample points. This will run the simulation and update the emulator model based on the simulator output.</p></div></div>',1),pe=B('<button class="svelte-18w6la0">Clear Samples</button>'),ue=B('<div class="grid-item energy-plot svelte-18w6la0"><h2 class="svelte-18w6la0">Flyby distance past Earth</h2> <div class="contour-container svelte-18w6la0"><canvas></canvas></div></div> <div class="grid-item buttons svelte-18w6la0"><div class="instruction svelte-18w6la0"><p class="svelte-18w6la0">Click directly on the plot to sample points. This will run the simulation and update the emulator model based on the simulator output.</p></div> <div class="vertical-button-group svelte-18w6la0"><!> <button class="info-button svelte-18w6la0"> </button></div></div> <div class="grid-item molecule-panel svelte-18w6la0"><h2 class="svelte-18w6la0">Asteroid Visualization</h2> <canvas class="svelte-18w6la0"></canvas></div>',1),me=B('<main class="svelte-18w6la0"><h1 class="svelte-18w6la0">Asteroid Explorer</h1> <div class="instruction svelte-18w6la0"><p class="svelte-18w6la0">Flyby distance is the closest approach distance given an object‚Äôs hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p></div> <div class="instruction svelte-18w6la0"><p class="highlight svelte-18w6la0">Your goal is to train an emulator that accurately predicts flyby distance using as few asteroid simulator runs as possible.</p></div> <div class="bars-container svelte-18w6la0"><div class="live-bar-container svelte-18w6la0"><div class="lives-label"> </div> <div class="live-bar svelte-18w6la0"><div class="lives-remaining svelte-18w6la0"></div> <span class="heart svelte-18w6la0">üí∑</span></div></div> <div></div> <div class="score-bar-container svelte-18w6la0"><div class="score-label">Score: <span id="score-percentage"> </span></div> <div class="score-bar svelte-18w6la0"><div class="score-value svelte-18w6la0" id="score-bar"></div> <span class="star svelte-18w6la0" id="score-star">‚≠ê</span></div></div></div> <!> <div><!></div> <div class="button-group svelte-18w6la0" style="margin-top: 20px; text-align: center;"><button class="info-button svelte-18w6la0"><span>Go back</span></button></div></main>');function ze(Yt,$t){ie($t,!1);const z=M();function Ot(){window.location.href="https://alan-turing-institute.github.io/gp-demo/"}const m={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let $=M(5e3),O=M(3),k=M([]),C=[],W=M(),P=M(),L=M(!1),H=M(!1),E=M(20),D=M(!1);const F=6371;function Ht(){localStorage.setItem("asteroidExplorerState",JSON.stringify({samples:a(k),gpPredictions:C,lives:a(E),score:a(z),gameEnded:a(D),showEnergyFunction:a(H),phi,psi}))}function Lt(){const t=localStorage.getItem("asteroidExplorerState");if(t){const s=JSON.parse(t);d(k,s.samples),C=s.gpPredictions,d(E,s.lives),d(z,s.score),d(D,s.gameEnded),d(H,s.showEnergyFunction),phi=s.phi,psi=s.psi}}let st=M(!1);function ot(){d(st,window.innerHeight>window.innerWidth)}Vt(()=>(Lt(),pt(),Q(),setTimeout(()=>{X()},100),ot(),window.addEventListener("resize",ot),()=>{Ht(),window.removeEventListener("resize",ot)}));function Xt(t,s,n=398600.4418,e=6371){const l=Math.sqrt(1+Math.pow(s,2)*Math.pow(t,4)/Math.pow(n,2)),i=n*(l-1)/Math.pow(t,2);return i>=e?i:0}function Z(t,s){return Xt(s,t)}const x=400,S=400,r=40,nt=x-2*r,N=ft().domain([5e3,5*F]).range([r,x-r]),J=ft().domain([3,20]).range([S-r,r]);let R=1/0,I=-1/0;function pt(){const s=it(5e3,5*F,(5*F-5e3)/50).toArray(),n=it(3,20,17/50).toArray();for(const e of s)for(const l of n){const i=Z(e,l);R=Math.min(R,i),I=Math.max(I,i)}R=Math.floor(R*10)/10,I=Math.ceil(I*10)/10,console.log(`Energy range: ${R} to ${I}`)}function ut(){d(k,[]),C=[],X(),d(E,20),d(z,0)}function mt(t){if(a(L)||a(E)<=0)return;const s=a(P).getBoundingClientRect(),n=a(P).width/s.width,e=a(P).height/s.height,l=(t.clientX-s.left)*n,i=(t.clientY-s.top)*e;if(l>=r&&l<=x-r&&i>=r&&i<=S-r){const o=N.invert(l),h=J.invert(i);d($,o),d(O,h);const b=Z(a($),a(O));d(k,[...a(k),{angle:a($),velocity:a(O),energy:b}]),d(E,a(E)-1),a(E)===0&&d(D,!0),Bt(),Q()}}function jt(){d(E,20),d(z,0),d(k,[]),C=[],d(D,!1),X()}function qt(t,s){if(t.length!==s.length||t.length===0)throw new Error("Arrays must be of the same length and non-empty");const n=t.reduce((o,h)=>o+h,0)/t.length,e=t.reduce((o,h)=>o+Math.pow(h-n,2),0),i=1-t.reduce((o,h,b)=>o+Math.pow(h-s[b],2),0)/e;return Math.max(0,i)}function Bt(){d(L,!0);let t=[],s=[];if(a(k).length===0){d(L,!1);return}setTimeout(()=>{const n=a(k).map(c=>[c.angle,c.velocity]),e=a(k).map(c=>c.energy),l=(c,v)=>{const p=(c[0]-v[0])/1e4,T=(c[1]-v[1])/5;return Math.exp(-.5*(p*p+T*T))},i=n.length,o=Gt(i,i);for(let c=0;c<i;c++)for(let v=0;v<i;v++)o.set([c,v],l(n[c],n[v]));const h=.01;for(let c=0;c<i;c++)o.set([c,c],o.get([c,c])+h);const b=40,y=it(5e3,5*F,(5*F-5e3)/b).toArray(),_=it(3,20,17/b).toArray();C=[];for(const c of y)for(const v of _){const p=[c,v],T=Gt(1,i);for(let w=0;w<i;w++)T.set([0,w],l(p,n[w]));try{const w=ve(o,e),j=de(T,w).get([0,0]);C.push({angle:c,velocity:v,predicted:j}),s.push(j),t.push(Z(c,v))}catch(w){console.error("Error in GP calculation:",w)}}X(),d(z,qt(t,s)),d(L,!1)},50)}function X(){if(!a(P))return;const t=a(P).getContext("2d");t.clearRect(0,0,a(P).width,a(P).height);const s=ce(It).domain([I,R]).interpolator(It);if(a(H)){const e=nt/80;for(let l=0;l<80;l++)for(let i=0;i<80;i++){const o=5e3+(5*F-5e3)*l/80,h=3+17*i/80,b=Z(o,h),y=N(o),_=J(h);t.fillStyle=s(b),t.fillRect(y-e/2,_-e/2,e,e)}}else if(C.length===0){const e=nt/80;for(let l=0;l<80;l++)for(let i=0;i<80;i++){const o=5e3+(5*F-5e3)*l/80,h=3+17*i/80,b=N(o),y=J(h);t.fillStyle=s(0),t.fillRect(b-e/2,y-e/2,e,e)}}else{const n=nt/Math.sqrt(C.length);C.forEach(e=>{const l=N(e.angle),i=J(e.velocity);t.fillStyle=s(e.predicted),t.fillRect(l-n/2,i-n/2,n,n)})}Dt(t,s),t.strokeStyle=m.primary,t.lineWidth=2,t.beginPath(),t.moveTo(r,S-r),t.lineTo(x-r,S-r),t.moveTo(r,r),t.lineTo(r,S-r),t.stroke(),t.fillStyle=m.text,t.font="12px Arial, sans-serif",t.textAlign="center",t.fillText("5000",r,S-r+15),t.fillText(String(5*F),x-r,S-r+15),t.fillText("Impact parameter (km)",x/2,S-r+20),t.textAlign="right",t.fillText("3",r-10,S-r),t.fillText("20",r-10,r),t.save(),t.translate(r-15,S/2-25),t.rotate(-Math.PI/2),t.fillText("Velocity (km/s)",0,0),t.restore(),a(k).forEach(n=>{const e=N(n.angle),l=J(n.velocity),i=10,o=t.createRadialGradient(e,l,2,e,l,i);o.addColorStop(0,m.highlight),o.addColorStop(1,"rgba(106, 137, 204, 0)"),t.fillStyle=o,t.beginPath(),t.arc(e,l,i,0,2*Math.PI),t.fill(),t.fillStyle=m.accent,t.beginPath(),t.arc(e,l,6,0,2*Math.PI),t.fill(),t.strokeStyle=m.primary,t.lineWidth=1,t.stroke()})}function Dt(t,s){const e=S-2*r,l=x-r+20,i=r,o=100,h=e/o;for(let v=0;v<o;v++){const p=R+(I-R)*(o-v-1)/o;t.fillStyle=s(p),t.fillRect(l,i+v*h,20,h+1)}t.strokeStyle=m.text,t.lineWidth=1,t.strokeRect(l,i,20,e),t.fillStyle=m.text,t.font="14px Arial, sans-serif",t.textAlign="left";const b=5,y=i+e;t.beginPath(),t.moveTo(l,y),t.lineTo(l+20,y),t.stroke(),t.fillText(R.toFixed(1),l+20+b,y+5);const _=i;t.beginPath(),t.moveTo(l,_),t.lineTo(l+20,_),t.stroke(),t.fillText(I.toFixed(1),l+20+b,_+5);const c=i+e/2;t.beginPath(),t.moveTo(l,c),t.stroke(),t.save(),t.translate(l-25,i+e/2),t.rotate(Math.PI/2),t.textAlign="center",t.fillText("Flyby Distance (km)",0,-60),t.restore()}function Q(){if(!a(W))return;const t=a(W).getContext("2d");t.clearRect(0,0,x,S);const e=ft().domain([5e3,5*F]).range([S-r-30,r])(a($)),l=r*2;t.save(),t.setLineDash([5,5]),t.beginPath(),t.moveTo(0,e),t.lineTo(x,e),t.strokeStyle=m.error,t.lineWidth=1,t.stroke(),t.restore();const i=20,o=12,h=2*Math.PI/o;t.beginPath();for(let tt=0;tt<o;tt++){const At=tt*h,le=.8+Math.random()*.4,Mt=i*le,zt=l+Mt*Math.cos(At),Et=e+Mt*Math.sin(At);tt===0?t.moveTo(zt,Et):t.lineTo(zt,Et)}t.closePath(),t.fillStyle=m.surface,t.fill(),t.strokeStyle=m.primary,t.lineWidth=2,t.stroke(),t.fillStyle=m.text,t.font="12px Arial",t.textAlign="center",t.fillText("Asteroid",l,e+i+15);const y=a(O)*10;t.beginPath(),t.moveTo(l,e),t.lineTo(l+y,e),t.strokeStyle=m.error,t.lineWidth=3,t.stroke();const _=8;t.beginPath(),t.moveTo(l+y,e),t.lineTo(l+y-_,e-_/2),t.lineTo(l+y-_,e+_/2),t.closePath(),t.fillStyle=m.error,t.fill();const c=l+y/2,v=e;t.fillStyle=m.text,t.font="12px Arial",t.textAlign="center",t.fillText("velocity",c+25,v-10);const p=20,T=x-r-p,w=S-r-p,j=t.createRadialGradient(T,w,p*.3,T,w,p);j.addColorStop(0,"#66ccff"),j.addColorStop(1,"#003366"),t.beginPath(),t.arc(T,w,p,0,2*Math.PI),t.fillStyle=j,t.fill(),t.strokeStyle="#002244",t.lineWidth=2,t.stroke(),t.beginPath(),t.moveTo(0,w),t.lineTo(x,w),t.strokeStyle=m.primary,t.lineWidth=2,t.stroke();const V=(l+T)/2;t.beginPath(),t.moveTo(V,e),t.lineTo(V,w),t.strokeStyle=m.text,t.lineWidth=1,t.stroke();const G=5;t.beginPath(),t.moveTo(V,e),t.lineTo(V-G,e+G),t.lineTo(V+G,e+G),t.closePath(),t.fillStyle=m.text,t.fill(),t.beginPath(),t.moveTo(V,w),t.lineTo(V-G,w-G),t.lineTo(V+G,w-G),t.closePath(),t.fillStyle=m.text,t.fill(),t.save(),t.fillStyle=m.text,t.font="12px Arial",t.textAlign="left",t.fillText("impact parameter",V+5,(e+w)/2),t.restore(),t.fillStyle=m.text,t.font="12px Arial",t.textAlign="center",t.fillText("Earth",T,w+p+15),t.fillStyle=m.text,t.font="14px Arial",t.textAlign="left",t.fillText(`Impact Parameter: ${a($).toFixed(0)} km`,20,30),t.fillText(`Velocity: ${a(O).toFixed(2)} km/s`,20,50)}function yt(){d(H,!a(H)),X()}Vt(()=>{console.log("Astroid canvas:",a(W)),console.log("Contour canvas:",a(P)),pt(),Q(),X()}),Ct(()=>{},()=>{d(z,0)}),Ct(()=>(a(W),a($),a(O)),()=>{a(W)&&(a($)!==void 0||a(O)!==void 0)&&Q()}),se(),re();var rt=me(),ct=u(f(rt),6),vt=f(ct),dt=f(vt),Nt=f(dt);g(dt);var wt=u(dt,2),bt=f(wt),Jt=u(bt,2);g(wt),g(vt);var St=u(vt,4),ht=f(St),_t=u(f(ht)),Kt=f(_t);g(_t),g(ht);var xt=u(ht,2),Tt=f(xt),Zt=u(Tt,2);g(xt),g(St),g(ct);var kt=u(ct,2);{var Qt=t=>{var s=he(),n=f(s),e=u(f(n),4),l=f(e);g(e);var i=u(e,2);g(n),g(s),et(o=>K(l,`Final score: ${o??""}%`),[()=>(a(z)*100).toFixed(0)],Wt),Y("click",i,jt),q(t,s)};at(kt,t=>{a(D)&&t(Qt)})}var U=u(kt,2),Ut=f(U);{var te=t=>{var s=ge(),n=Ft(s),e=u(f(n),2);A(e,"width",x),A(e,"height",S),lt(e,v=>d(W,v),()=>a(W)),g(n);var l=u(n,2),i=u(f(l),2),o=f(i);A(o,"width",x+60),A(o,"height",S),lt(o,v=>d(P,v),()=>a(P)),g(i);var h=u(i,2),b=f(h);{var y=v=>{var p=fe();Y("click",p,ut),q(v,p)};at(b,v=>{a(k).length>0&&v(y)})}var _=u(b,2),c=f(_,!0);g(_),g(h),ne(2),g(l),et(()=>{gt(o,1,Rt(a(L)?"loading":""),"svelte-18w6la0"),K(c,a(H)?"Show Emulator Prediction":"Show Simulator Function")}),Y("click",o,mt),Y("click",_,yt),q(t,s)},ee=t=>{var s=ue(),n=Ft(s),e=u(f(n),2),l=f(e);A(l,"width",x+60),A(l,"height",S),lt(l,p=>d(P,p),()=>a(P)),g(e),g(n);var i=u(n,2),o=u(f(i),2),h=f(o);{var b=p=>{var T=pe();Y("click",T,ut),q(p,T)};at(h,p=>{a(k).length>0&&p(b)})}var y=u(h,2),_=f(y,!0);g(y),g(o),g(i);var c=u(i,2),v=u(f(c),2);A(v,"width",x),A(v,"height",S),lt(v,p=>d(W,p),()=>a(W)),g(c),et(()=>{gt(l,1,Rt(a(L)?"loading":""),"svelte-18w6la0"),K(_,a(H)?"Show Emulator Prediction":"Show Simulator Function")}),Y("click",l,mt),Y("click",y,yt),q(t,s)};at(Ut,t=>{a(st)?t(ee,!1):t(te)})}g(U);var Pt=u(U,2),ae=f(Pt);g(Pt),g(rt),et((t,s)=>{K(Nt,`Guesses left ${a(E)??""}/20`),A(bt,"style",`width: ${t??""}%`),A(Jt,"style",`left: ${t??""}%`),K(Kt,`${s??""}%`),A(Tt,"style",`width: ${a(z)*100}%`),A(Zt,"style",`left: ${a(z)*100}%`),gt(U,1,`responsive-grid ${(a(st)?"vertical":"horizontal")??""}`,"svelte-18w6la0")},[()=>Math.max(0,a(E)/20*100),()=>(a(z)*100).toFixed(0)],Wt),Y("click",ae,Ot),q(Yt,rt),oe()}export{ze as component};
