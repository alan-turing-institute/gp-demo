import{t as ht,a as it}from"../chunks/XXpPz1rO.js";import"../chunks/CG3dSJ55.js";import{am as kt,as as wt,at as At,ar as zt,an as Ct,s as u,ao as v,i as Et,e as n,au as w,Q as m,ap as p,aq as Vt}from"../chunks/C9kX8gL9.js";import{e as J,s as q}from"../chunks/CWldEeeP.js";import{i as It}from"../chunks/DDIuJh5f.js";import{s as H}from"../chunks/BK-Xurv5.js";import{l as lt,s as Wt,c as Rt}from"../chunks/C0MQ2VaA.js";import{b as rt}from"../chunks/CUbg1kqr.js";import{i as Ft}from"../chunks/CmZZvN_p.js";import{o as Gt}from"../chunks/DWMzei4F.js";import{r as L,s as $t,v as ct,z as gt,l as qt,m as Ht}from"../chunks/BoOaU208.js";var Lt=ht('<button class="svelte-hsjngg">Clear Samples</button>'),Xt=ht('<main class="svelte-hsjngg"><h1 class="svelte-hsjngg">Astroid with Velocity Vector Explorer</h1> <div class="container svelte-hsjngg"><div class="panel svelte-hsjngg"><h2 class="svelte-hsjngg">Astroid Visualization</h2> <canvas class="svelte-hsjngg"></canvas></div> <div class="panel svelte-hsjngg"><h2 class="svelte-hsjngg">Energy Landscape</h2> <div class="contour-container svelte-hsjngg"><canvas></canvas></div> <div class="info svelte-hsjngg"><p class="svelte-hsjngg"> </p> <p class="svelte-hsjngg"> </p> <div class="instruction svelte-hsjngg"><p class="highlight svelte-hsjngg">Click on the plot above to add sample points and update the GP model</p></div> <div class="button-group svelte-hsjngg"><!> <button class="info-button svelte-hsjngg"> </button></div> <div class="energy-function svelte-hsjngg"><h3 class="svelte-hsjngg">About the Visualization:</h3> <p class="svelte-hsjngg"> </p> <p class="svelte-hsjngg">The energy function (flyby distance) represents the closest approach distance given an objectâ€™s hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p> <p class="svelte-hsjngg">Click directly on the plot to add sample points and build a GP model that learns this landscape.</p></div></div></div></div></main>');function ee(dt,ft){kt(ft,!1);const j={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50"};let x=w(5e3),T=w(3),b=w([]),A=[],k=w(),z=w(),E=w(!1),V=w(!1);const M=6371;function vt(t,r,g=398600.4418,e=6371){const s=Math.sqrt(1+Math.pow(r,2)*Math.pow(t,4)/Math.pow(g,2)),a=g*(s-1)/Math.pow(t,2);return a>=e?a:0}function R(t,r){return vt(r,t)}const f=400,c=400,o=40,U=f-2*o,F=lt().domain([5e3,5*M]).range([o,f-o]),G=lt().domain([3,20]).range([c-o,o]);let y=1/0,S=-1/0;function pt(){const r=L(5e3,5*M,(5*M-5e3)/50).toArray(),g=L(3,20,17/50).toArray();for(const e of r)for(const s of g){const a=R(e,s);y=Math.min(y,a),S=Math.max(S,a)}y=Math.floor(y*10)/10,S=Math.ceil(S*10)/10,console.log(`Energy range: ${y} to ${S}`)}function yt(){m(b,[]),A=[],$()}function ut(t){if(n(E))return;const r=n(z).getBoundingClientRect(),g=t.clientX-r.left,e=t.clientY-r.top;if(g>=o&&g<=f-o&&e>=o&&e<=c-o){const s=F.invert(g),a=G.invert(e);m(x,s),m(T,a);const l=R(n(x),n(T));m(b,[...n(b),{angle:n(x),velocity:n(T),energy:l}]),mt(),X()}}function mt(){if(m(E,!0),n(b).length===0){m(E,!1);return}setTimeout(()=>{const t=n(b).map(i=>[i.angle,i.velocity]),r=n(b).map(i=>i.energy),g=(i,d)=>{const C=(i[0]-d[0])/1e4,W=(i[1]-d[1])/5;return Math.exp(-.5*(C*C+W*W))},e=t.length,s=gt(e,e);for(let i=0;i<e;i++)for(let d=0;d<e;d++)s.set([i,d],g(t[i],t[d]));const a=.01;for(let i=0;i<e;i++)s.set([i,i],s.get([i,i])+a);const l=40,h=L(5e3,5*M,(5*M-5e3)/l).toArray(),_=L(3,20,17/l).toArray();A=[];for(const i of h)for(const d of _){const C=[i,d],W=gt(1,e);for(let P=0;P<e;P++)W.set([0,P],g(C,t[P]));try{const P=qt(s,r),jt=Ht(W,P).get([0,0]);A.push({angle:i,velocity:d,predicted:jt})}catch(P){console.error("Error in GP calculation:",P)}}$(),m(E,!1)},50)}function $(){if(!n(z))return;const t=n(z).getContext("2d");t.clearRect(0,0,f,c);const r=$t(ct).domain([S,y]).interpolator(ct);if(n(V)||A.length===0){const s=U/80;for(let a=0;a<80;a++)for(let l=0;l<80;l++){const h=5e3+(5*M-5e3)*a/80,_=3+17*l/80,i=R(h,_),d=F(h),C=G(_);t.fillStyle=r(i),t.fillRect(d-s/2,C-s/2,s,s)}}else{const e=U/Math.sqrt(A.length);A.forEach(s=>{const a=F(s.angle),l=G(s.velocity);t.fillStyle=r(s.predicted),t.fillRect(a-e/2,l-e/2,e,e)})}bt(t,r),t.strokeStyle=j.primary,t.lineWidth=2,t.beginPath(),t.moveTo(o,c-o),t.lineTo(f-o,c-o),t.moveTo(o,o),t.lineTo(o,c-o),t.stroke(),t.fillStyle=j.text,t.font="bold 14px Arial, sans-serif",t.textAlign="center";const g=Math.round((5e3+5*M)/2);t.fillText("5000",o,c-o+15),t.fillText(g.toString(),f/2,c-o+15),t.fillText(String(5*M),f-o,c-o+15),t.fillText("impact parameter (km)",f-o+15,c-o+5),t.textAlign="right",t.fillText("3",o-5,c-o),t.fillText("11.5",o-5,c/2),t.fillText("20",o-5,o),t.fillText("Velocity (km/s)",o-15,o-10),n(b).forEach(e=>{const s=F(e.angle),a=G(e.velocity),l=8,h=t.createRadialGradient(s,a,2,s,a,l);h.addColorStop(0,j.highlight),h.addColorStop(1,"rgba(106, 137, 204, 0)"),t.fillStyle=h,t.beginPath(),t.arc(s,a,l,0,2*Math.PI),t.fill(),t.fillStyle=j.accent,t.beginPath(),t.arc(s,a,4,0,2*Math.PI),t.fill(),t.strokeStyle=j.primary,t.lineWidth=1,t.stroke()})}function bt(t,r){const e=c-2*o,s=f-o+20,a=o,l=100,h=e/l;for(let i=0;i<l;i++){const d=y+(S-y)*(l-i-1)/l;t.fillStyle=r(d),t.fillRect(s,a+i*h,20,h+1)}t.strokeStyle=j.text,t.lineWidth=1,t.strokeRect(s,a,20,e),t.fillStyle=j.text,t.font="12px Arial, sans-serif",t.textAlign="left",t.fillText(y.toFixed(1),s+20+5,a+e),t.fillText(S.toFixed(1),s+20+5,a);const _=(y+S)/2;t.fillText(_.toFixed(1),s+20+5,a+e/2),t.save(),t.translate(s+20+25,a+e/2),t.rotate(-Math.PI/2),t.textAlign="center",t.fillText("Distance to Earth",0,0),t.restore()}function X(){if(!n(k))return;const t=n(k).getContext("2d");t.clearRect(0,0,f,c);const r=f/2,g=c/2,e=120;t.save(),t.translate(r,g),t.rotate(n(x)*Math.PI/180),t.beginPath();for(let l=0;l<=2*Math.PI;l+=.01){const h=e*Math.pow(Math.cos(l),3),_=e*Math.pow(Math.sin(l),3);l===0?t.moveTo(h,_):t.lineTo(h,_)}t.closePath(),t.fillStyle="rgba(200,200,200,0.3)",t.fill(),t.strokeStyle="#333",t.lineWidth=2,t.stroke();const s=n(T)*50;t.strokeStyle="#cc0000",t.lineWidth=2,t.beginPath(),t.moveTo(e,0),t.lineTo(e+s,0),t.stroke();const a=8;t.beginPath(),t.moveTo(e+s,0),t.lineTo(e+s-a,-8/2),t.lineTo(e+s-a,a/2),t.closePath(),t.fillStyle="#cc0000",t.fill(),t.fillStyle="#0066cc",t.beginPath(),t.arc(0,0,5,0,2*Math.PI),t.fill(),t.fillStyle="#00cc00",t.beginPath(),t.arc(e,0,5,0,2*Math.PI),t.fill(),t.restore(),t.fillStyle="#000",t.font="14px Arial",t.textAlign="left",t.fillText(`impact parameter: ${n(x).toFixed(0)} km`,20,30),t.fillText(`Velocity: ${n(T).toFixed(2)} km/s`,20,50)}function St(){m(V,!n(V)),$()}Gt(()=>{console.log("Astroid canvas:",n(k)),console.log("Contour canvas:",n(z)),pt(),X(),$()}),wt(()=>(n(k),n(x),n(T)),()=>{n(k)&&(n(x)!==void 0||n(T)!==void 0)&&X()}),At(),Ft();var B=Xt(),tt=u(v(B),2),O=v(tt),Y=u(v(O),2);H(Y,"width",f),H(Y,"height",c),rt(Y,t=>m(k,t),()=>n(k)),p(O);var et=u(O,2),D=u(v(et),2),I=v(D);H(I,"width",f+60),H(I,"height",c),rt(I,t=>m(z,t),()=>n(z)),p(D);var nt=u(D,2),K=v(nt),_t=v(K);p(K);var N=u(K,2),xt=v(N);p(N);var Q=u(N,4),st=v(Q);{var Tt=t=>{var r=Lt();J("click",r,yt),it(t,r)};It(st,t=>{n(b).length>0&&t(Tt)})}var Z=u(st,2),Mt=v(Z,!0);p(Z),p(Q);var ot=u(Q,2),at=u(v(ot),2),Pt=v(at,!0);p(at),Vt(4),p(ot),p(nt),p(et),p(tt),p(B),zt(t=>{Wt(I,1,Rt(n(E)?"loading":""),"svelte-hsjngg"),q(_t,`Samples: ${n(b).length??""}`),q(xt,`Current energy: ${t??""}`),q(Mt,n(V)?"Show GP Prediction":"Show Energy Function"),q(Pt,n(V)?"Showing actual energy function":"Showing Gaussian Process prediction")},[()=>R(n(x),n(T)).toFixed(2)],Et),J("click",I,ut),J("click",Z,St),it(dt,B),Ct()}export{ee as component};
