import{t as B,a as q}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as oe,aa as Vt,ab as ne,s as p,a9 as et,a5 as re,a6 as d,i as Wt,e as i,ac as P,a1 as b,a8 as It,a7 as h,f as Ft}from"../chunks/BJ4irGt7.js";import{e as $,s as N}from"../chunks/CvaqDwXv.js";import{i as st}from"../chunks/lIaEYNz1.js";import{s as k}from"../chunks/B9r3SdpA.js";import{l as gt,s as bt,c as $t}from"../chunks/dhIx7U5O.js";import{b as it}from"../chunks/CUY-1DrG.js";import{i as ce}from"../chunks/CkfO92w8.js";import{o as Gt}from"../chunks/Cpzjerpz.js";import{r as at,s as ve,v as Yt,z as Lt,l as de,m as he}from"../chunks/PBAI84v4.js";var fe=B('<div class="game-ended-popup svelte-1v2s6zb"><div class="popup-content svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Game Ended</h2> <p class="svelte-1v2s6zb">You have used all your budget!</p> <p class="svelte-1v2s6zb"> </p> <button class="svelte-1v2s6zb">Play Again</button></div></div>'),pe=B('<button class="svelte-1v2s6zb">Clear Samples</button>'),ge=B('<div class="panel svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Asteroid Visualization</h2> <canvas class="svelte-1v2s6zb"></canvas></div> <div class="panel svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Flyby distance past Earth</h2> <div class="contour-container svelte-1v2s6zb"><canvas></canvas></div> <div class="button-group svelte-1v2s6zb"><!> <button class="info-button svelte-1v2s6zb"> </button></div> <div class="side_instruction svelte-1v2s6zb"><p class="svelte-1v2s6zb">Click directly on the plot</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Sample points with velocity and impact factor</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Run the simulation</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Update the emulator model</p></div></div>',1),be=B('<button class="svelte-1v2s6zb">Clear Samples</button>'),ue=B('<div class="grid-item energy-plot svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Flyby distance past Earth</h2> <div class="contour-container svelte-1v2s6zb"><canvas></canvas></div></div> <div class="grid-item buttons svelte-1v2s6zb"><div class="side_instruction svelte-1v2s6zb"><p class="svelte-1v2s6zb">Click directly on the plot</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Sample points with velocity and impact factor</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Run the simulation</p> <div class="arrow-down svelte-1v2s6zb"></div> <p class="svelte-1v2s6zb">Update the emulator model</p></div> <div class="vertical-button-group svelte-1v2s6zb"><!> <button class="info-button svelte-1v2s6zb"> </button></div></div> <div class="grid-item molecule-panel svelte-1v2s6zb"><h2 class="svelte-1v2s6zb">Asteroid Visualization</h2> <canvas class="svelte-1v2s6zb"></canvas></div>',1),me=B('<main class="svelte-1v2s6zb"><h1 style="display: inline-flex; align-items: center; font-size: 3rem;" class="svelte-1v2s6zb"><img src="https://raw.githubusercontent.com/alan-turing-institute/gp-demo/refs/heads/main/static/asteroid.png" alt="Asteroid Explorer Icon" style="width: 80px; height: 80px; margin-right: 15px; border-radius: 0; box-shadow: none;" class="svelte-1v2s6zb"> Asteroid Explorer</h1> <div class="instruction svelte-1v2s6zb"><p class="svelte-1v2s6zb">Calculating the trajectory of celestial bodies like asteroids or comets approaching Earth is costly and time-consuming due to gravitational interactions, relativistic effects, and observational uncertainties. Training an emulator offers a cheaper and sufficiently accurate alternative.</p> <p class="svelte-1v2s6zb">üíª Lets train an emulator that can predict if an asteroid will coloide with the Earth.</p> <p class="svelte-1v2s6zb"></p> <p class="svelte-1v2s6zb">üìê Adjust the velocity and the impact parameter to explore the Flyby distance map.</p></div> <div class="bars-container svelte-1v2s6zb"><div class="live-bar-container svelte-1v2s6zb"><div class="lives-label"> </div> <div class="live-bar svelte-1v2s6zb"><div class="lives-remaining svelte-1v2s6zb"></div> <span class="heart svelte-1v2s6zb">üí∑</span></div></div> <div></div> <div class="score-bar-container svelte-1v2s6zb"><div class="score-label">Score: <span id="score-percentage"> </span></div> <div class="score-bar svelte-1v2s6zb"><div class="score-value svelte-1v2s6zb" id="score-bar"></div> <span class="star svelte-1v2s6zb" id="score-star">‚≠ê</span></div></div></div> <!> <div><!></div> <div class="button-group svelte-1v2s6zb" style="margin-top: 20px; text-align: center;"><button class="info-button svelte-1v2s6zb"><span>Go back</span></button></div></main>');function Ee(Ht,Xt){oe(Xt,!1);const V=P();function Ot(){window.location.href="https://alan-turing-institute.github.io/gp-demo/"}const u={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let G=P(5e3),Y=P(3),A=P([]);const H=10;let L=[],M=P(),T=P(),X=P(!1),D=P(!1),W=P(H),lt=P(!1);const E=6371;let ot=P(!1);function nt(){b(ot,window.innerHeight>window.innerWidth)}Gt(()=>(ut(),J(),setTimeout(()=>{O()},100),nt(),window.addEventListener("resize",nt),()=>{window.removeEventListener("resize",nt)}));function jt(t,o,n=398600.4418,e=6371){const s=Math.sqrt(1+Math.pow(o,2)*Math.pow(t,4)/Math.pow(n,2)),a=n*(s-1)/Math.pow(t,2);return a>=e?a:0}function Z(t,o){return jt(o,t)}const x=400,S=400,r=40,rt=x-2*r,K=gt().domain([5e3,5*E]).range([r,x-r]),U=gt().domain([3,20]).range([S-r,r]);let C=1/0,I=-1/0;function ut(){const o=at(5e3,5*E,(5*E-5e3)/50).toArray(),n=at(3,20,17/50).toArray();for(const e of o)for(const s of n){const a=Z(e,s);C=Math.min(C,a),I=Math.max(I,a)}C=Math.floor(C*10)/10,I=Math.ceil(I*10)/10,console.log(`Energy range: ${C} to ${I}`)}function mt(){b(A,[]),L=[],O(),b(W,H),b(V,0)}function yt(t){if(i(X)||i(W)<=0)return;const o=i(T).getBoundingClientRect(),n=i(T).width/o.width,e=i(T).height/o.height,s=(t.clientX-o.left)*n,a=(t.clientY-o.top)*e;if(s>=r&&s<=x-r&&a>=r&&a<=S-r){const l=K.invert(s),f=U.invert(a);b(G,l),b(Y,f);const z=Z(i(G),i(Y));b(A,[...i(A),{angle:i(G),velocity:i(Y),energy:z}]),b(W,i(W)-1),i(W)===0&&b(lt,!0),Dt(),J()}}function qt(){b(W,H),b(V,0),b(A,[]),L=[],b(lt,!1),O()}function Bt(t,o){if(t.length!==o.length||t.length===0)throw new Error("Arrays must be of the same length and non-empty");const n=t.reduce((l,f)=>l+f,0)/t.length,e=t.reduce((l,f)=>l+Math.pow(f-n,2),0),a=1-t.reduce((l,f,z)=>l+Math.pow(f-o[z],2),0)/e;return Math.max(0,a)}function Dt(){b(X,!0);let t=[],o=[];if(i(A).length===0){b(X,!1);return}setTimeout(()=>{const n=i(A).map(c=>[c.angle,c.velocity]),e=i(A).map(c=>c.energy),s=(c,v)=>{const g=(c[0]-v[0])/1e4,w=(c[1]-v[1])/5;return Math.exp(-.5*(g*g+w*w))},a=n.length,l=Lt(a,a);for(let c=0;c<a;c++)for(let v=0;v<a;v++)l.set([c,v],s(n[c],n[v]));const f=.01;for(let c=0;c<a;c++)l.set([c,c],l.get([c,c])+f);const z=40,m=at(5e3,5*E,(5*E-5e3)/z).toArray(),_=at(3,20,17/z).toArray();L=[];for(const c of m)for(const v of _){const g=[c,v],w=Lt(1,a);for(let y=0;y<a;y++)w.set([0,y],s(g,n[y]));try{const y=de(l,e),j=he(w,y).get([0,0]);L.push({angle:c,velocity:v,predicted:j}),o.push(j),t.push(Z(c,v))}catch(y){console.error("Error in GP calculation:",y)}}O(),b(V,Bt(t,o)),b(X,!1)},50)}function O(){if(!i(T))return;const t=i(T).getContext("2d");t.clearRect(0,0,i(T).width,i(T).height);const o=ve(Yt).domain([I,C]).interpolator(Yt);if(i(D)){const e=rt/80;for(let s=0;s<80;s++)for(let a=0;a<80;a++){const l=5e3+(5*E-5e3)*s/80,f=3+17*a/80,z=Z(l,f),m=K(l),_=U(f);t.fillStyle=o(z),t.fillRect(m-e/2,_-e/2,e,e)}}else if(L.length===0){const e=rt/80;for(let s=0;s<80;s++)for(let a=0;a<80;a++){const l=5e3+(5*E-5e3)*s/80,f=3+17*a/80,z=K(l),m=U(f);t.fillStyle=o(0),t.fillRect(z-e/2,m-e/2,e,e)}}else{const n=rt/Math.sqrt(L.length);L.forEach(e=>{const s=K(e.angle),a=U(e.velocity);t.fillStyle=o(e.predicted),t.fillRect(s-n/2,a-n/2,n,n)})}Kt(t,o),t.strokeStyle=u.primary,t.lineWidth=2,t.beginPath(),t.moveTo(r,S-r),t.lineTo(x-r,S-r),t.moveTo(r,r),t.lineTo(r,S-r),t.stroke(),t.fillStyle=u.text,t.font="12px Arial, sans-serif",t.textAlign="center",t.fillText("5000",r,S-r+15),t.fillText(String(5*E),x-r,S-r+15),t.fillText("Impact parameter (km)",x/2,S-r+20),t.textAlign="right",t.fillText("3",r-10,S-r),t.fillText("20",r-10,r),t.save(),t.translate(r-15,S/2-25),t.rotate(-Math.PI/2),t.fillText("Velocity (km/s)",0,0),t.restore(),i(A).forEach(n=>{const e=K(n.angle),s=U(n.velocity),a=10,l=t.createRadialGradient(e,s,2,e,s,a);l.addColorStop(0,u.highlight),l.addColorStop(1,"rgba(106, 137, 204, 0)"),t.fillStyle=l,t.beginPath(),t.arc(e,s,a,0,2*Math.PI),t.fill(),t.fillStyle=u.accent,t.beginPath(),t.arc(e,s,6,0,2*Math.PI),t.fill(),t.strokeStyle=u.primary,t.lineWidth=1,t.stroke()})}function Kt(t,o){const e=S-2*r,s=x-r+20,a=r,l=100,f=e/l;for(let v=0;v<l;v++){const g=C+(I-C)*(l-v-1)/l;t.fillStyle=o(g),t.fillRect(s,a+v*f,20,f+1)}t.strokeStyle=u.text,t.lineWidth=1,t.strokeRect(s,a,20,e),t.fillStyle=u.text,t.font="14px Arial, sans-serif",t.textAlign="left";const z=5,m=a+e;t.beginPath(),t.moveTo(s,m),t.lineTo(s+20,m),t.stroke(),t.fillText(C.toFixed(1),s+20+z,m+5);const _=a;t.beginPath(),t.moveTo(s,_),t.lineTo(s+20,_),t.stroke(),t.fillText(I.toFixed(1),s+20+z,_+5);const c=a+e/2;t.beginPath(),t.moveTo(s,c),t.stroke(),t.save(),t.translate(s-25,a+e/2),t.rotate(Math.PI/2),t.textAlign="center",t.fillText("Flyby Distance (km)",0,-60),t.restore()}function J(){if(!i(M))return;const t=i(M).getContext("2d");t.clearRect(0,0,x,S);const e=gt().domain([5e3,5*E]).range([S-r-30,r])(i(G)),s=r*2;t.save(),t.setLineDash([5,5]),t.beginPath(),t.moveTo(0,e),t.lineTo(x,e),t.strokeStyle=u.error,t.lineWidth=1,t.stroke(),t.restore();const a=20,l=12,f=2*Math.PI/l;t.beginPath();for(let tt=0;tt<l;tt++){const Mt=tt*f,le=.8+Math.random()*.4,Et=a*le,Ct=s+Et*Math.cos(Mt),Rt=e+Et*Math.sin(Mt);tt===0?t.moveTo(Ct,Rt):t.lineTo(Ct,Rt)}t.closePath(),t.fillStyle=u.surface,t.fill(),t.strokeStyle=u.primary,t.lineWidth=2,t.stroke(),t.fillStyle=u.text,t.font="12px Arial",t.textAlign="center",t.fillText("Asteroid",s,e+a+15);const m=i(Y)*10;t.beginPath(),t.moveTo(s,e),t.lineTo(s+m,e),t.strokeStyle=u.error,t.lineWidth=3,t.stroke();const _=8;t.beginPath(),t.moveTo(s+m,e),t.lineTo(s+m-_,e-_/2),t.lineTo(s+m-_,e+_/2),t.closePath(),t.fillStyle=u.error,t.fill();const c=s+m/2,v=e;t.fillStyle=u.text,t.font="12px Arial",t.textAlign="center",t.fillText("velocity",c+25,v-10);const g=20,w=x-r-g,y=S-r-g,j=t.createRadialGradient(w,y,g*.3,w,y,g);j.addColorStop(0,"#66ccff"),j.addColorStop(1,"#003366"),t.beginPath(),t.arc(w,y,g,0,2*Math.PI),t.fillStyle=j,t.fill(),t.strokeStyle="#002244",t.lineWidth=2,t.stroke(),t.beginPath(),t.moveTo(0,y),t.lineTo(x,y),t.strokeStyle=u.primary,t.lineWidth=2,t.stroke();const R=(s+w)/2;t.beginPath(),t.moveTo(R,e),t.lineTo(R,y),t.strokeStyle=u.text,t.lineWidth=1,t.stroke();const F=5;t.beginPath(),t.moveTo(R,e),t.lineTo(R-F,e+F),t.lineTo(R+F,e+F),t.closePath(),t.fillStyle=u.text,t.fill(),t.beginPath(),t.moveTo(R,y),t.lineTo(R-F,y-F),t.lineTo(R+F,y-F),t.closePath(),t.fillStyle=u.text,t.fill(),t.save(),t.fillStyle=u.text,t.font="12px Arial",t.textAlign="left",t.fillText("impact parameter",R+5,(e+y)/2),t.restore(),t.fillStyle=u.text,t.font="12px Arial",t.textAlign="center",t.fillText("Earth",w,y+g+15),t.fillStyle=u.text,t.font="14px Arial",t.textAlign="left",t.fillText(`Impact Parameter: ${i(G).toFixed(0)} km`,20,30),t.fillText(`Velocity: ${i(Y).toFixed(2)} km/s`,20,50)}function zt(){b(D,!i(D)),O()}Gt(()=>{console.log("Astroid canvas:",i(M)),console.log("Contour canvas:",i(T)),ut(),J(),O()}),Vt(()=>{},()=>{b(V,0)}),Vt(()=>(i(M),i(G),i(Y)),()=>{i(M)&&(i(G)!==void 0||i(Y)!==void 0)&&J()}),ne(),ce();var ct=me(),vt=p(d(ct),2),Ut=p(d(vt),4);Ut.textContent=`üí∑ You have a budget to run ${H} simulations to train your emulator.`,It(2),h(vt);var dt=p(vt,2),ht=d(dt),ft=d(ht),Nt=d(ft);h(ft);var St=p(ft,2),_t=d(St),Zt=p(_t,2);h(St),h(ht);var xt=p(ht,4),pt=d(xt),wt=p(d(pt)),Jt=d(wt);h(wt),h(pt);var Tt=p(pt,2),kt=d(Tt),Qt=p(kt,2);h(Tt),h(xt),h(dt);var Pt=p(dt,2);{var te=t=>{var o=fe(),n=d(o),e=p(d(n),4),s=d(e);h(e);var a=p(e,2);h(n),h(o),et(l=>N(s,`Final score: ${l??""}%`),[()=>(i(V)*100).toFixed(0)],Wt),$("click",a,qt),q(t,o)};st(Pt,t=>{i(lt)&&t(te)})}var Q=p(Pt,2),ee=d(Q);{var se=t=>{var o=ge(),n=Ft(o),e=p(d(n),2);k(e,"width",x),k(e,"height",S),it(e,v=>b(M,v),()=>i(M)),h(n);var s=p(n,2),a=p(d(s),2),l=d(a);k(l,"width",x+60),k(l,"height",S),it(l,v=>b(T,v),()=>i(T)),h(a);var f=p(a,2),z=d(f);{var m=v=>{var g=pe();$("click",g,mt),q(v,g)};st(z,v=>{i(A).length>0&&v(m)})}var _=p(z,2),c=d(_,!0);h(_),h(f),It(2),h(s),et(()=>{bt(l,1,$t(i(X)?"loading":""),"svelte-1v2s6zb"),N(c,i(D)?"Show Emulator Prediction":"Show Simulator Function")}),$("click",l,yt),$("click",_,zt),q(t,o)},ie=t=>{var o=ue(),n=Ft(o),e=p(d(n),2),s=d(e);k(s,"width",x+60),k(s,"height",S),it(s,g=>b(T,g),()=>i(T)),h(e),h(n);var a=p(n,2),l=p(d(a),2),f=d(l);{var z=g=>{var w=be();$("click",w,mt),q(g,w)};st(f,g=>{i(A).length>0&&g(z)})}var m=p(f,2),_=d(m,!0);h(m),h(l),h(a);var c=p(a,2),v=p(d(c),2);k(v,"width",x),k(v,"height",S),it(v,g=>b(M,g),()=>i(M)),h(c),et(()=>{bt(s,1,$t(i(X)?"loading":""),"svelte-1v2s6zb"),N(_,i(D)?"Show Emulator Prediction":"Show Simulator Function")}),$("click",s,yt),$("click",m,zt),q(t,o)};st(ee,t=>{i(ot)?t(ie,!1):t(se)})}h(Q);var At=p(Q,2),ae=d(At);h(At),h(ct),et((t,o)=>{N(Nt,`Budget left ${i(W)??""}/${H}`),k(_t,"style",`width: ${t??""}%`),k(Zt,"style",`left: ${t??""}%`),N(Jt,`${o??""}%`),k(kt,"style",`width: ${i(V)*100}%`),k(Qt,"style",`left: ${i(V)*100}%`),bt(Q,1,`responsive-grid ${(i(ot)?"vertical":"horizontal")??""}`,"svelte-1v2s6zb")},[()=>Math.max(0,i(W)/H*100),()=>(i(V)*100).toFixed(0)],Wt),$("click",ae,Ot),q(Ht,ct),re()}export{Ee as component};
