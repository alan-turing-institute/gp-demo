import{t as Te,a as me}from"../chunks/cGtBC6Qd.js";import"../chunks/7LKkzqbz.js";import{a4 as Fe,aa as Ye,ab as Le,a9 as Xe,a5 as $e,s as T,a6 as y,i as He,e as a,ac as R,a1 as x,a7 as m,a8 as Oe}from"../chunks/BJ4irGt7.js";import{e as ie,s as j}from"../chunks/CvaqDwXv.js";import{i as qe}from"../chunks/lIaEYNz1.js";import{s as B}from"../chunks/B9r3SdpA.js";import{l as le,s as je,c as Be}from"../chunks/dhIx7U5O.js";import{b as ue}from"../chunks/CUY-1DrG.js";import{i as De}from"../chunks/CkfO92w8.js";import{o as Ke}from"../chunks/Cpzjerpz.js";import{r as D,s as Ne,v as Se,z as be,l as Ze,m as Je}from"../chunks/PBAI84v4.js";var Qe=Te('<button class="svelte-1p6hea8">Clear Samples</button>'),Ue=Te('<main class="svelte-1p6hea8"><h1 class="svelte-1p6hea8">Astroid with Velocity Vector Explorer</h1> <div class="container svelte-1p6hea8"><div class="panel svelte-1p6hea8"><h2 class="svelte-1p6hea8">Astroid Visualization</h2> <canvas class="svelte-1p6hea8"></canvas></div> <div class="panel svelte-1p6hea8"><h2 class="svelte-1p6hea8">Energy Landscape</h2> <div class="contour-container svelte-1p6hea8"><canvas></canvas></div> <div class="info svelte-1p6hea8"><p class="svelte-1p6hea8"> </p> <p class="svelte-1p6hea8"> </p> <div class="instruction svelte-1p6hea8"><p class="highlight svelte-1p6hea8">Click on the plot above to add sample points and update the GP model</p></div> <div class="button-group svelte-1p6hea8"><!> <button class="info-button svelte-1p6hea8"> </button></div> <div class="energy-function svelte-1p6hea8"><h3 class="svelte-1p6hea8">About the Visualization:</h3> <p class="svelte-1p6hea8"> </p> <p class="svelte-1p6hea8">The energy function (flyby distance) represents the closest approach distance given an objectâ€™s hyperbolic speed and impact parameter. A value of 0 indicates a collision with Earth.</p> <p class="svelte-1p6hea8">Click directly on the plot to add sample points and build a GP model that learns this landscape.</p></div></div></div></div></main>');function ht(xe,Pe){Fe(Pe,!1);const c={primary:"#3c6382",accent:"#60a3bc",highlight:"#6a89cc",text:"#2c3e50",surface:"#dcdde1",error:"#e55039"};let M=R(5e3),w=R(3),P=R([]),I=[],V=R(),G=R(),F=R(!1),Y=R(!1);const W=6371;function _e(e,d,s=398600.4418,t=6371){const o=Math.sqrt(1+Math.pow(d,2)*Math.pow(e,4)/Math.pow(s,2)),n=s*(o-1)/Math.pow(e,2);return n>=t?n:0}function X(e,d){return _e(d,e)}const v=400,f=400,i=40,ne=v-2*i,$=le().domain([5e3,5*W]).range([i,v-i]),H=le().domain([3,20]).range([f-i,i]);let S=1/0,_=-1/0;function ke(){const d=D(5e3,5*W,(5*W-5e3)/50).toArray(),s=D(3,20,17/50).toArray();for(const t of d)for(const o of s){const n=X(t,o);S=Math.min(S,n),_=Math.max(_,n)}S=Math.floor(S*10)/10,_=Math.ceil(_*10)/10,console.log(`Energy range: ${S} to ${_}`)}function Ae(){x(P,[]),I=[],O()}function Me(e){if(a(F))return;const d=a(G).getBoundingClientRect(),s=e.clientX-d.left,t=e.clientY-d.top;if(s>=i&&s<=v-i&&t>=i&&t<=f-i){const o=$.invert(s),n=H.invert(t);x(M,o),x(w,n);const h=X(a(M),a(w));x(P,[...a(P),{angle:a(M),velocity:a(w),energy:h}]),we(),K()}}function we(){if(x(F,!0),a(P).length===0){x(F,!1);return}setTimeout(()=>{const e=a(P).map(l=>[l.angle,l.velocity]),d=a(P).map(l=>l.energy),s=(l,r)=>{const b=(l[0]-r[0])/1e4,g=(l[1]-r[1])/5;return Math.exp(-.5*(b*b+g*g))},t=e.length,o=be(t,t);for(let l=0;l<t;l++)for(let r=0;r<t;r++)o.set([l,r],s(e[l],e[r]));const n=.01;for(let l=0;l<t;l++)o.set([l,l],o.get([l,l])+n);const h=40,k=D(5e3,5*W,(5*W-5e3)/h).toArray(),z=D(3,20,17/h).toArray();I=[];for(const l of k)for(const r of z){const b=[l,r],g=be(1,t);for(let p=0;p<t;p++)g.set([0,p],s(b,e[p]));try{const p=Ze(o,d),E=Je(g,p).get([0,0]);I.push({angle:l,velocity:r,predicted:E})}catch(p){console.error("Error in GP calculation:",p)}}O(),x(F,!1)},50)}function O(){if(!a(G))return;const e=a(G).getContext("2d");e.clearRect(0,0,v,f);const d=Ne(Se).domain([_,S]).interpolator(Se);if(a(Y)||I.length===0){const t=ne/80;for(let o=0;o<80;o++)for(let n=0;n<80;n++){const h=5e3+(5*W-5e3)*o/80,k=3+17*n/80,z=X(h,k),l=$(h),r=H(k);e.fillStyle=d(z),e.fillRect(l-t/2,r-t/2,t,t)}}else{const s=ne/Math.sqrt(I.length);I.forEach(t=>{const o=$(t.angle),n=H(t.velocity);e.fillStyle=d(t.predicted),e.fillRect(o-s/2,n-s/2,s,s)})}We(e,d),e.strokeStyle=c.primary,e.lineWidth=2,e.beginPath(),e.moveTo(i,f-i),e.lineTo(v-i,f-i),e.moveTo(i,i),e.lineTo(i,f-i),e.stroke(),e.fillStyle=c.text,e.font="12px Arial, sans-serif",e.textAlign="center",e.fillText("5000",i,f-i+15),e.fillText(String(5*W),v-i,f-i+15),e.fillText("Impact parameter (km)",v/2,f-i+30),e.textAlign="right",e.fillText("3",i-10,f-i),e.fillText("20",i-10,i),e.save(),e.translate(i-30,f/2),e.rotate(-Math.PI/2),e.fillText("Velocity (km/s)",0,0),e.restore(),a(P).forEach(s=>{const t=$(s.angle),o=H(s.velocity),n=10,h=e.createRadialGradient(t,o,2,t,o,n);h.addColorStop(0,c.highlight),h.addColorStop(1,"rgba(106, 137, 204, 0)"),e.fillStyle=h,e.beginPath(),e.arc(t,o,n,0,2*Math.PI),e.fill(),e.fillStyle=c.accent,e.beginPath(),e.arc(t,o,6,0,2*Math.PI),e.fill(),e.strokeStyle=c.primary,e.lineWidth=1,e.stroke()})}function We(e,d){const t=f-2*i,o=v-i+20,n=i,h=100,k=t/h;for(let g=0;g<h;g++){const p=S+(_-S)*(h-g-1)/h;e.fillStyle=d(p),e.fillRect(o,n+g*k,20,k+1)}e.strokeStyle=c.text,e.lineWidth=1,e.strokeRect(o,n,20,t),e.fillStyle=c.text,e.font="14px Arial, sans-serif",e.textAlign="left";const z=5,l=n+t;e.beginPath(),e.moveTo(o,l),e.lineTo(o+20,l),e.stroke(),e.fillText(S.toFixed(1),o+20+z,l+5);const r=n;e.beginPath(),e.moveTo(o,r),e.lineTo(o+20,r),e.stroke(),e.fillText(_.toFixed(1),o+20+z,r+5);const b=n+t/2;e.beginPath(),e.moveTo(o,b),e.lineTo(o+20,b),e.stroke(),e.fillText(((S+_)/2).toFixed(1),o+20+z,b+5),e.save(),e.translate(o-25,n+t/2),e.rotate(Math.PI/2),e.textAlign="center",e.fillText("Flyby Distance (km)",0,0),e.restore()}function K(){if(!a(V))return;const e=a(V).getContext("2d");e.clearRect(0,0,v,f);const t=le().domain([5e3,5*W]).range([f-i-30,i])(a(M)),o=i*2;e.save(),e.setLineDash([5,5]),e.beginPath(),e.moveTo(0,t),e.lineTo(v,t),e.strokeStyle=c.error,e.lineWidth=1,e.stroke(),e.restore();const n=20,h=12,k=2*Math.PI/h;e.beginPath();for(let q=0;q<h;q++){const pe=q*k,Ge=.8+Math.random()*.4,ve=n*Ge,ge=o+ve*Math.cos(pe),ye=t+ve*Math.sin(pe);q===0?e.moveTo(ge,ye):e.lineTo(ge,ye)}e.closePath(),e.fillStyle=c.surface,e.fill(),e.strokeStyle=c.primary,e.lineWidth=2,e.stroke();const l=a(w)*10;e.beginPath(),e.moveTo(o,t),e.lineTo(o+l,t),e.strokeStyle=c.error,e.lineWidth=3,e.stroke();const r=8;e.beginPath(),e.moveTo(o+l,t),e.lineTo(o+l-r,t-r/2),e.lineTo(o+l-r,t+r/2),e.closePath(),e.fillStyle=c.error,e.fill();const b=o+l/2,g=t;e.fillStyle=c.text,e.font="12px Arial",e.textAlign="center",e.fillText("velocity",b,g-10);const p=20,E=v-i-p,u=f-i-p,ae=e.createRadialGradient(E,u,p*.3,E,u,p);ae.addColorStop(0,"#66ccff"),ae.addColorStop(1,"#003366"),e.beginPath(),e.arc(E,u,p,0,2*Math.PI),e.fillStyle=ae,e.fill(),e.strokeStyle="#002244",e.lineWidth=2,e.stroke(),e.beginPath(),e.moveTo(0,u),e.lineTo(v,u),e.strokeStyle=c.primary,e.lineWidth=2,e.stroke();const A=(o+E)/2;e.beginPath(),e.moveTo(A,t),e.lineTo(A,u),e.strokeStyle=c.text,e.lineWidth=1,e.stroke();const C=5;e.beginPath(),e.moveTo(A,t),e.lineTo(A-C,t+C),e.lineTo(A+C,t+C),e.closePath(),e.fillStyle=c.text,e.fill(),e.beginPath(),e.moveTo(A,u),e.lineTo(A-C,u-C),e.lineTo(A+C,u-C),e.closePath(),e.fillStyle=c.text,e.fill(),e.save(),e.fillStyle=c.text,e.font="12px Arial",e.textAlign="left",e.fillText("impact parameter",A+5,(t+u)/2),e.restore(),e.fillStyle=c.text,e.font="12px Arial",e.textAlign="center",e.fillText("Earth",E,u-p-5),e.fillStyle=c.text,e.font="14px Arial",e.textAlign="left",e.fillText(`Impact Parameter: ${a(M).toFixed(0)} km`,20,30),e.fillText(`Velocity: ${a(w).toFixed(2)} km/s`,20,50)}function ze(){x(Y,!a(Y)),O()}Ke(()=>{console.log("Astroid canvas:",a(V)),console.log("Contour canvas:",a(G)),ke(),K(),O()}),Ye(()=>(a(V),a(M),a(w)),()=>{a(V)&&(a(M)!==void 0||a(w)!==void 0)&&K()}),Le(),De();var N=Ue(),se=T(y(N),2),Z=y(se),J=T(y(Z),2);B(J,"width",v),B(J,"height",f),ue(J,e=>x(V,e),()=>a(V)),m(Z);var re=T(Z,2),Q=T(y(re),2),L=y(Q);B(L,"width",v+60),B(L,"height",f),ue(L,e=>x(G,e),()=>a(G)),m(Q);var ce=T(Q,2),U=y(ce),Ce=y(U);m(U);var ee=T(U,2),Ve=y(ee);m(ee);var te=T(ee,4),de=y(te);{var Ee=e=>{var d=Qe();ie("click",d,Ae),me(e,d)};qe(de,e=>{a(P).length>0&&e(Ee)})}var oe=T(de,2),Re=y(oe,!0);m(oe),m(te);var he=T(te,2),fe=T(y(he),2),Ie=y(fe,!0);m(fe),Oe(4),m(he),m(ce),m(re),m(se),m(N),Xe(e=>{je(L,1,Be(a(F)?"loading":""),"svelte-1p6hea8"),j(Ce,`Samples: ${a(P).length??""}`),j(Ve,`Current energy: ${e??""}`),j(Re,a(Y)?"Show GP Prediction":"Show Energy Function"),j(Ie,a(Y)?"Showing actual energy function":"Showing Gaussian Process prediction")},[()=>X(a(M),a(w)).toFixed(2)],He),ie("click",L,Me),ie("click",oe,ze),me(xe,N),$e()}export{ht as component};
